<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0f172a">
    <title>LifeQuest RPG - Party Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #ec4899;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --darker: #020617;
            --light: #f8fafc;
            --accent: #8b5cf6;
            --xp: #fbbf24;
            --gold: #f59e0b;
            --party: #06b6d4;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--darker);
            color: var(--light);
            overflow-x: hidden;
            min-height: 100vh;
            padding-bottom: 90px;
        }

        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 50%);
            animation: bgPulse 8s ease-in-out infinite;
        }

        @keyframes bgPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .mobile-header {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-actions {
            display: flex;
            gap: 0.8rem;
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            color: var(--light);
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s;
        }

        .icon-btn:hover {
            background: rgba(99, 102, 241, 0.3);
            transform: scale(1.1);
        }

        .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            font-size: 0.7rem;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
        }

        .quick-stat {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 0.6rem;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }

        .quick-stat:hover {
            transform: translateY(-2px);
            border-color: var(--primary);
        }

        .quick-stat-icon {
            font-size: 1.1rem;
            margin-bottom: 0.2rem;
        }

        .quick-stat-value {
            font-family: 'Orbitron', monospace;
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--xp);
        }

        .quick-stat-label {
            font-size: 0.6rem;
            color: #64748b;
            text-transform: uppercase;
        }

        .character-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(236, 72, 153, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 20px;
            margin: 1rem;
            padding: 1.2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }

        .character-avatar {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            flex-shrink: 0;
            box-shadow: 0 0 30px rgba(99, 102, 241, 0.5);
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .character-avatar:hover {
            transform: scale(1.1);
        }

        .level-ring {
            position: absolute;
            inset: -5px;
            border: 2px solid transparent;
            border-top-color: var(--xp);
            border-radius: 50%;
            animation: spin 4s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .character-info {
            flex: 1;
        }

        .character-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            margin-bottom: 0.2rem;
        }

        .character-class {
            font-size: 0.85rem;
            color: #94a3b8;
            margin-bottom: 0.6rem;
        }

        .character-bars {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }

        .bar-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .bar-label {
            font-size: 0.7rem;
            color: #64748b;
            width: 25px;
        }

        .bar {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .hp-fill { background: linear-gradient(90deg, var(--danger), var(--warning)); }
        .xp-fill { background: linear-gradient(90deg, var(--xp), #f59e0b); }

        .tabs {
            display: flex;
            gap: 0.5rem;
            padding: 0 1rem;
            margin-bottom: 1rem;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            padding: 0.7rem 1.2rem;
            color: #94a3b8;
            font-family: inherit;
            font-size: 0.85rem;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .tab.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
        }

        .section {
            display: none;
            padding: 0 1rem;
            animation: fadeIn 0.3s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: #94a3b8;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .category-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary);
            transition: all 0.3s;
        }

        .category-card:hover {
            transform: translateX(5px);
            border-color: rgba(99, 102, 241, 0.4);
        }

        .category-card.health { border-left-color: var(--success); }
        .category-card.work { border-left-color: var(--primary); }
        .category-card.mind { border-left-color: var(--secondary); }
        .category-card.social { border-left-color: var(--warning); }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.8rem;
        }

        .category-title-group {
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }

        .category-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }

        .health-icon { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .work-icon { background: rgba(99, 102, 241, 0.2); color: var(--primary); }
        .mind-icon { background: rgba(236, 72, 153, 0.2); color: var(--secondary); }
        .social-icon { background: rgba(245, 158, 11, 0.2); color: var(--warning); }

        .category-title {
            font-weight: 700;
            font-size: 1rem;
        }

        .category-progress {
            font-size: 0.75rem;
            color: #64748b;
        }

        .quest-list {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }

        .quest-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            touch-action: pan-y;
        }

        .quest-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: transparent;
            transition: all 0.3s;
        }

        .quest-item:hover::before {
            background: var(--primary);
        }

        .quest-item:active {
            transform: scale(0.98);
        }

        .quest-item.completed {
            opacity: 0.6;
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.05);
        }

        .quest-item.completed::before {
            background: var(--success);
        }

        .quest-item.resetting {
            animation: resetPulse 0.5s;
        }

        @keyframes resetPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); background: rgba(99, 102, 241, 0.2); }
            100% { transform: scale(1); }
        }

        .quest-checkbox {
            width: 26px;
            height: 26px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.3s;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .quest-item:hover .quest-checkbox {
            border-color: var(--primary);
            transform: scale(1.1);
        }

        .quest-item.completed .quest-checkbox {
            background: var(--success);
            border-color: var(--success);
            animation: checkPop 0.3s;
        }

        @keyframes checkPop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .quest-content {
            flex: 1;
            min-width: 0;
        }

        .quest-title {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: all 0.3s;
        }

        .quest-item.completed .quest-title {
            text-decoration: line-through;
            color: #64748b;
        }

        .quest-meta {
            display: flex;
            gap: 0.6rem;
            font-size: 0.7rem;
            color: #64748b;
            align-items: center;
            flex-wrap: wrap;
        }

        .streak-badge {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning);
            padding: 0.15rem 0.4rem;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 0.2rem;
            font-weight: 600;
        }

        .difficulty-dots {
            display: flex;
            gap: 2px;
        }

        .dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
        }

        .dot.active { background: var(--warning); }

        .quest-reward {
            text-align: right;
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }

        .xp-reward {
            color: var(--xp);
            font-weight: 700;
            font-family: 'Orbitron', monospace;
            font-size: 0.85rem;
        }

        .gold-reward {
            color: var(--gold);
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 0.2rem;
        }

        .quest-actions {
            display: flex;
            gap: 0.3rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .quest-item:hover .quest-actions {
            opacity: 1;
        }

        .quest-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .quest-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .quest-btn.delete:hover {
            background: rgba(239, 68, 68, 0.4);
        }

        .quest-btn.edit {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary);
        }

        .quest-btn.edit:hover {
            background: rgba(99, 102, 241, 0.4);
        }

        .party-section {
            padding: 0 1rem;
        }

        .party-code-card {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(99, 102, 241, 0.1));
            border: 2px dashed var(--party);
            border-radius: 16px;
            padding: 1.2rem;
            text-align: center;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .party-code-label {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .party-code-value {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            color: var(--party);
            letter-spacing: 4px;
            margin-bottom: 1rem;
            text-shadow: 0 0 20px rgba(6, 182, 212, 0.5);
        }

        .party-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        .btn {
            padding: 0.7rem 1.2rem;
            border-radius: 25px;
            border: none;
            font-family: inherit;
            font-size: 0.85rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--party), var(--primary));
            color: white;
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .party-members {
            margin-bottom: 1.5rem;
        }

        .members-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.8rem;
            margin-top: 0.8rem;
        }

        .member-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 0.8rem;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }

        .member-card:hover {
            transform: translateY(-3px);
            border-color: var(--party);
        }

        .member-card.leader {
            border-color: var(--xp);
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.2);
        }

        .member-card.you {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .member-avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            margin: 0 auto 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            position: relative;
        }

        .member-status {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 12px;
            height: 12px;
            background: var(--success);
            border-radius: 50%;
            border: 2px solid var(--dark);
        }

        .member-name {
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 0.2rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .member-level {
            font-size: 0.7rem;
            color: #64748b;
        }

        .leader-badge {
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--xp);
            color: var(--dark);
            font-size: 0.6rem;
            padding: 0.1rem 0.4rem;
            border-radius: 10px;
            font-weight: 700;
        }

        .boss-card {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(245, 158, 11, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 16px;
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .boss-card::before {
            content: 'ðŸ‘¹';
            position: absolute;
            right: -20px;
            top: -20px;
            font-size: 6rem;
            opacity: 0.1;
        }

        .boss-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 1rem;
        }

        .boss-icon {
            font-size: 2rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .boss-info h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--danger);
            font-size: 1.1rem;
            margin-bottom: 0.2rem;
        }

        .boss-info p {
            font-size: 0.8rem;
            color: #94a3b8;
        }

        .boss-hp-container {
            margin-bottom: 1rem;
        }

        .boss-hp-bar {
            height: 24px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .boss-hp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--danger), var(--warning));
            transition: width 0.5s ease;
            position: relative;
        }

        .boss-hp-text {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            text-shadow: 0 1px 2px rgba(0,0,0,0.8);
            font-family: 'Orbitron', monospace;
        }

        .boss-rewards {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .reward-tag {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .reward-tag.xp { color: var(--xp); background: rgba(251, 191, 36, 0.15); }
        .reward-tag.gold { color: var(--gold); background: rgba(245, 158, 11, 0.15); }
        .reward-tag.item { color: var(--party); background: rgba(6, 182, 212, 0.15); }

        .chat-container {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
        }

        .chat-header {
            padding: 0.8rem 1rem;
            background: rgba(6, 182, 212, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--party);
        }

        .chat-messages {
            height: 180px;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }

        .chat-message {
            display: flex;
            gap: 0.6rem;
            align-items: flex-start;
            animation: messageSlide 0.3s;
        }

        @keyframes messageSlide {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .chat-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(99, 102, 241, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .chat-content {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            padding: 0.5rem 0.8rem;
            border-radius: 12px;
            border-top-left-radius: 4px;
        }

        .chat-author {
            font-size: 0.75rem;
            color: var(--party);
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .chat-text {
            font-size: 0.85rem;
            color: #cbd5e1;
        }

        .chat-input-container {
            padding: 0.8rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 0.5rem;
        }

        .chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 0.6rem 1rem;
            color: white;
            font-family: inherit;
            font-size: 0.9rem;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--party);
        }

        .chat-send {
            width: 36px;
            height: 36px;
            background: var(--party);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .chat-send:active {
            transform: scale(0.9);
        }

        .shop-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .shop-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.2rem;
            text-align: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .shop-item:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.2);
        }

        .shop-item.locked {
            opacity: 0.5;
            filter: grayscale(0.8);
        }

        .shop-item.locked:hover {
            transform: none;
            border-color: rgba(255, 255, 255, 0.1);
        }

        .shop-icon {
            font-size: 2.5rem;
            margin-bottom: 0.8rem;
            display: block;
        }

        .shop-name {
            font-size: 0.95rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
        }

        .shop-desc {
            font-size: 0.75rem;
            color: #64748b;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        .shop-price {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(251, 191, 36, 0.1));
            color: var(--gold);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .shop-item.locked .shop-price {
            background: rgba(255, 255, 255, 0.05);
            color: #64748b;
            border-color: rgba(255, 255, 255, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.2rem;
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        .stat-value-big {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.3rem;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label-big {
            font-size: 0.8rem;
            color: #64748b;
        }

        .achievements-list {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .achievement-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s;
        }

        .achievement-item.unlocked {
            background: rgba(99, 102, 241, 0.1);
            border-color: var(--primary);
        }

        .achievement-icon {
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .achievement-item.unlocked .achievement-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(99, 102, 241, 0.5); }
            50% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.8); }
        }

        .achievement-info {
            flex: 1;
        }

        .achievement-name {
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .achievement-desc {
            font-size: 0.75rem;
            color: #64748b;
        }

        .fab {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.5);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .fab:hover {
            transform: scale(1.1) rotate(90deg);
        }

        .fab:active {
            transform: scale(0.9);
        }

        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            align-items: flex-end;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: var(--dark);
            border-top: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 24px 24px 0 0;
            padding: 1.5rem;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            transform: translateY(100%);
            transition: transform 0.3s;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            color: #64748b;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: #94a3b8;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--light);
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.08);
        }

        .difficulty-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
        }

        .difficulty-btn {
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #64748b;
            font-family: inherit;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .difficulty-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .difficulty-btn.active {
            background: rgba(99, 102, 241, 0.3);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.3);
        }

        .submit-btn {
            width: 100%;
            padding: 1.2rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 12px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .toast-container {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            pointer-events: none;
        }

        .toast {
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-left: 4px solid var(--success);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            animation: toastSlide 0.3s;
            min-width: 280px;
        }

        @keyframes toastSlide {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .toast-icon {
            font-size: 1.5rem;
        }

        .toast-content h4 {
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
            color: var(--light);
        }

        .toast-content p {
            font-size: 0.8rem;
            color: #94a3b8;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(99, 102, 241, 0.2);
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            padding: 0.6rem 0 calc(0.6rem + env(safe-area-inset-bottom));
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.2rem;
            color: #64748b;
            text-decoration: none;
            font-size: 0.65rem;
            transition: all 0.3s;
            padding: 0.3rem 0;
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-icon {
            font-size: 1.4rem;
            transition: transform 0.3s;
        }

        .nav-item.active .nav-icon {
            transform: translateY(-3px);
        }

        .levelup-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 4000;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .levelup-overlay.active {
            display: flex;
            opacity: 1;
        }

        .levelup-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            color: var(--xp);
            margin-bottom: 1rem;
            animation: pulse 1s infinite;
            text-align: center;
        }

        .levelup-level {
            font-size: 5rem;
            font-weight: 900;
            background: linear-gradient(to right, var(--xp), #f59e0b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: countUp 1s ease-out;
        }

        @keyframes countUp {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .avatar-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.8rem;
            margin-top: 0.5rem;
        }

        .avatar-option {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .avatar-option:hover {
            background: rgba(99, 102, 241, 0.2);
            transform: scale(1.1);
        }

        .avatar-option.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.3);
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.5);
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin-bottom: 0.8rem;
        }

        .settings-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toggle {
            width: 50px;
            height: 26px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 13px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle.active {
            background: var(--success);
        }

        .toggle-knob {
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: all 0.3s;
        }

        .toggle.active .toggle-knob {
            left: 26px;
        }

        @media (min-width: 768px) {
            .container {
                max-width: 600px;
                margin: 0 auto;
            }
            
            .members-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--darker);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        /* PROFILE SECTION STYLES */
        .profile-header {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(236, 72, 153, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 20px;
            padding: 2rem 1.5rem;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .profile-avatar-large {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            position: relative;
            cursor: pointer;
            box-shadow: 0 0 30px rgba(99, 102, 241, 0.5);
            transition: transform 0.3s;
        }

        .profile-avatar-large:hover {
            transform: scale(1.05);
        }

        .edit-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .profile-avatar-large:hover .edit-overlay {
            opacity: 1;
        }

        .profile-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }

        .profile-email {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-bottom: 1.5rem;
        }

        .profile-stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .profile-stat {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1rem;
        }

        .profile-stat-value {
            font-family: 'Orbitron', monospace;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--xp);
            margin-bottom: 0.2rem;
        }

        .profile-stat-label {
            font-size: 0.75rem;
            color: #64748b;
        }

        .profile-menu {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s;
        }

        .menu-item:last-child {
            border-bottom: none;
        }

        .menu-item:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .menu-item:active {
            background: rgba(99, 102, 241, 0.2);
        }

        .menu-icon {
            font-size: 1.3rem;
            margin-right: 1rem;
            width: 30px;
            text-align: center;
        }

        .menu-text {
            flex: 1;
            font-size: 0.95rem;
        }

        .menu-arrow {
            color: #64748b;
            font-size: 1.2rem;
        }

        .menu-badge {
            background: var(--primary);
            color: white;
            font-size: 0.75rem;
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-weight: 600;
        }

        .profile-achievements-preview {
            margin-bottom: 2rem;
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.8rem;
        }

        .achievement-preview {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            opacity: 0.5;
        }

        .achievement-preview.unlocked {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(236, 72, 153, 0.1));
            border-color: var(--primary);
            opacity: 1;
        }

        .form-info {
            background: rgba(99, 102, 241, 0.1);
            border-left: 3px solid var(--primary);
            padding: 0.8rem 1rem;
            border-radius: 0 8px 8px 0;
            margin-bottom: 1rem;
        }

        /* ACHIEVEMENTS DETAIL SECTION */
        .achievements-detail-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(236, 72, 153, 0.05));
            border-radius: 20px;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .achievements-detail-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .achievements-progress {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .achievements-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.5s ease;
        }

        .achievements-count-text {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-top: 0.5rem;
        }

        .achievement-detail-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.2rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .achievement-detail-card.unlocked {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(236, 72, 153, 0.05));
            border-color: var(--primary);
        }

        .achievement-detail-card.locked {
            opacity: 0.6;
        }

        .achievement-detail-card.locked::after {
            content: 'ðŸ”’';
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.2rem;
        }

        .achievement-detail-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            flex-shrink: 0;
        }

        .achievement-detail-card.unlocked .achievement-detail-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            animation: glow 2s infinite;
        }

        .achievement-detail-info {
            flex: 1;
        }

        .achievement-detail-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            margin-bottom: 0.3rem;
        }

        .achievement-detail-desc {
            font-size: 0.85rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
        }

        .achievement-detail-date {
            font-size: 0.75rem;
            color: var(--success);
            font-weight: 600;
        }

        .achievement-detail-card.locked .achievement-detail-date {
            color: #64748b;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: var(--primary);
        }

        /* NOTIFICATIONS SECTION */
        .notifications-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .notifications-header h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
        }

        .notification-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            transition: all 0.3s;
            cursor: pointer;
        }

        .notification-item:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: var(--primary);
        }

        .notification-item.unread {
            background: rgba(99, 102, 241, 0.05);
            border-left: 3px solid var(--primary);
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            background: rgba(99, 102, 241, 0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 0.2rem;
            font-size: 0.95rem;
        }

        .notification-text {
            font-size: 0.85rem;
            color: #94a3b8;
            margin-bottom: 0.3rem;
        }

        .notification-time {
            font-size: 0.75rem;
            color: #64748b;
        }

        .clear-all-btn {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--danger);
            padding: 0.6rem 1.2rem;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.85rem;
            margin-bottom: 1rem;
            transition: all 0.3s;
        }

        .clear-all-btn:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #64748b;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 1rem;
        }

        /* ACHIEVEMENTS CATEGORIES */
        .achievements-categories {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
        }

        .achievements-categories::-webkit-scrollbar {
            display: none;
        }

        .achievement-category-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            color: #94a3b8;
            font-family: inherit;
            font-size: 0.8rem;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .achievement-category-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .achievement-category-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-color: transparent;
            color: white;
        }

        .achievement-progress-mini {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .achievement-progress-mini-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s;
        }

        /* CONFIRMATION DIALOG */
        .confirm-dialog {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 5000;
            display: none;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .confirm-dialog.active {
            display: flex;
            opacity: 1;
        }

        .confirm-box {
            background: var(--dark);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 20px;
            padding: 2rem;
            max-width: 320px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .confirm-dialog.active .confirm-box {
            transform: scale(1);
        }

        .confirm-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .confirm-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .confirm-text {
            color: #94a3b8;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
        }

        .confirm-buttons {
            display: flex;
            gap: 1rem;
        }

        .confirm-btn {
            flex: 1;
            padding: 0.8rem;
            border-radius: 12px;
            border: none;
            font-family: inherit;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .confirm-btn.cancel {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
        }

        .confirm-btn.cancel:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .confirm-btn.confirm {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
        }

        .confirm-btn.confirm:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }

        /* DAILY RESET INFO */
        .daily-reset-info {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            padding: 0.8rem 1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 0.85rem;
            color: #94a3b8;
        }

        .daily-reset-info .icon {
            font-size: 1.2rem;
        }

        /* QUEST EDIT MODAL */
        .quest-edit-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .quest-edit-btn {
            flex: 1;
            padding: 0.8rem;
            border-radius: 12px;
            border: none;
            font-family: inherit;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
        }

        .quest-edit-btn.save {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .quest-edit-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .quest-edit-btn:hover {
            transform: translateY(-2px);
        }

        /* LAST RESET INFO */
        .last-reset-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary);
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Confirmation Dialog -->
    <div class="confirm-dialog" id="confirm-dialog">
        <div class="confirm-box">
            <div class="confirm-icon" id="confirm-icon">âš ï¸</div>
            <div class="confirm-title" id="confirm-title">Â¿EstÃ¡s seguro?</div>
            <div class="confirm-text" id="confirm-text">Esta acciÃ³n no se puede deshacer</div>
            <div class="confirm-buttons">
                <button class="confirm-btn cancel" onclick="closeConfirmDialog()">Cancelar</button>
                <button class="confirm-btn confirm" id="confirm-action-btn" onclick="executeConfirmAction()">Confirmar</button>
            </div>
        </div>
    </div>

    <header class="mobile-header">
        <div class="header-top">
            <div class="logo">LifeQuest</div>
            <div class="header-actions">
                <button class="icon-btn" onclick="showSection('notifications')" title="Notificaciones">
                    ðŸ””
                    <span class="badge" id="notif-badge" style="display: none;">0</span>
                </button>
                <button class="icon-btn" onclick="showSection('party')" title="Party">
                    ðŸ‘¥
                    <span class="badge" id="party-badge" style="background: var(--party);">3</span>
                </button>
            </div>
        </div>
        <div class="quick-stats">
            <div class="quick-stat">
                <div class="quick-stat-icon">âš¡</div>
                <div class="quick-stat-value" id="stat-xp">0</div>
                <div class="quick-stat-label">XP</div>
            </div>
            <div class="quick-stat">
                <div class="quick-stat-icon">ðŸª™</div>
                <div class="quick-stat-value" id="stat-gold">100</div>
                <div class="quick-stat-label">ORO</div>
            </div>
            <div class="quick-stat">
                <div class="quick-stat-icon">ðŸ”¥</div>
                <div class="quick-stat-value" id="stat-streak">0</div>
                <div class="quick-stat-label">RACHA</div>
            </div>
            <div class="quick-stat">
                <div class="quick-stat-icon">â¤ï¸</div>
                <div class="quick-stat-value" id="stat-hp">100</div>
                <div class="quick-stat-label">HP</div>
            </div>
        </div>
    </header>

    <div class="character-card">
        <div class="character-avatar" onclick="openProfileModal()">
            <div class="level-ring"></div>
            <span id="avatar-emoji">ðŸ§™â€â™‚ï¸</span>
        </div>
        <div class="character-info">
            <div class="character-name" id="char-name">HÃ©roe</div>
            <div class="character-class" id="char-class">Nv. 1 Aventurero</div>
            <div class="character-bars">
                <div class="bar-container">
                    <span class="bar-label">HP</span>
                    <div class="bar">
                        <div class="bar-fill hp-fill" id="hp-bar" style="width: 100%"></div>
                    </div>
                </div>
                <div class="bar-container">
                    <span class="bar-label">XP</span>
                    <div class="bar">
                        <div class="bar-fill xp-fill" id="xp-bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Edit Modal -->
    <div class="modal-overlay" id="profile-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ‘¤ Editar Perfil</h3>
                <button class="modal-close" onclick="closeProfileModal()">Ã—</button>
            </div>
            <form onsubmit="saveProfile(event)">
                <div class="form-group">
                    <label class="form-label">Nombre de hÃ©roe</label>
                    <input type="text" class="form-input" id="edit-name" maxlength="15" placeholder="Tu nombre">
                </div>
                <div class="form-group">
                    <label class="form-label">Selecciona avatar</label>
                    <div class="avatar-grid" id="avatar-grid"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">ConfiguraciÃ³n</label>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>ðŸ””</span> Notificaciones
                        </div>
                        <div class="toggle active" id="notif-toggle" onclick="toggleSetting('notifications')">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>ðŸ”Š</span> Sonidos
                        </div>
                        <div class="toggle active" id="sound-toggle" onclick="toggleSetting('sounds')">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
                <button type="submit" class="submit-btn">Guardar Cambios</button>
            </form>
        </div>
    </div>

    <div class="tabs">
        <button class="tab active" onclick="showSection('quests')">
            <span>âš”ï¸</span> Misiones
        </button>
        <button class="tab" onclick="showSection('party')">
            <span>ðŸ‘¥</span> Party
        </button>
        <button class="tab" onclick="showSection('shop')">
            <span>ðŸŽ</span> Tienda
        </button>
        <button class="tab" onclick="showSection('profile')">
            <span>ðŸ‘¤</span> Perfil
        </button>
    </div>

    <section id="quests-section" class="section active">
        <div class="daily-reset-info">
            <span class="icon">ðŸŒ…</span>
            <span>Las misiones se reinician automÃ¡ticamente cada dÃ­a a las 5:00 AM</span>
        </div>

        <div class="category-card health">
            <div class="category-header">
                <div class="category-title-group">
                    <div class="category-icon health-icon">ðŸ’š</div>
                    <div>
                        <div class="category-title">Salud & Fitness</div>
                        <div class="category-progress" id="health-progress">0/2 completadas</div>
                    </div>
                </div>
            </div>
            <div class="quest-list" id="health-quests"></div>
        </div>

        <div class="category-card work">
            <div class="category-header">
                <div class="category-title-group">
                    <div class="category-icon work-icon">ðŸ’¼</div>
                    <div>
                        <div class="category-title">Trabajo & Productividad</div>
                        <div class="category-progress" id="work-progress">0/1 completadas</div>
                    </div>
                </div>
            </div>
            <div class="quest-list" id="work-quests"></div>
        </div>

        <div class="category-card mind">
            <div class="category-header">
                <div class="category-title-group">
                    <div class="category-icon mind-icon">ðŸ§˜</div>
                    <div>
                        <div class="category-title">Mente & Crecimiento</div>
                        <div class="category-progress" id="mind-progress">0/1 completadas</div>
                    </div>
                </div>
            </div>
            <div class="quest-list" id="mind-quests"></div>
        </div>

        <div class="category-card social">
            <div class="category-header">
                <div class="category-title-group">
                    <div class="category-icon social-icon">ðŸ¤</div>
                    <div>
                        <div class="category-title">Social & Relaciones</div>
                        <div class="category-progress" id="social-progress">0/1 completadas</div>
                    </div>
                </div>
            </div>
            <div class="quest-list" id="social-quests"></div>
        </div>
    </section>

    <section id="party-section" class="section party-section">
        <div class="party-code-card">
            <div class="party-code-label">CÃ³digo de Party</div>
            <div class="party-code-value" id="party-code">XP7-9Q2</div>
            <div class="party-actions">
                <button class="btn btn-primary" onclick="shareParty()">
                    <span>ðŸ“¤</span> Invitar
                </button>
                <button class="btn btn-secondary" onclick="joinParty()">
                    <span>âž•</span> Unirse
                </button>
            </div>
        </div>

        <div class="party-members">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                <h3 class="section-title" style="margin: 0;">Miembros</h3>
                <span style="font-size: 0.8rem; color: #64748b;" id="member-count">3/4</span>
            </div>
            <div class="members-grid" id="members-grid"></div>
        </div>

        <div class="boss-card">
            <div class="boss-header">
                <div class="boss-icon">ðŸ‘¹</div>
                <div class="boss-info">
                    <h3>ProcrastinaciÃ³n Suprema</h3>
                    <p>Jefe Semanal â€¢ Nv. 5</p>
                </div>
            </div>
            <div class="boss-hp-container">
                <div class="boss-hp-bar">
                    <div class="boss-hp-fill" id="boss-hp-bar" style="width: 75%"></div>
                    <div class="boss-hp-text" id="boss-hp-text">750/1000 HP</div>
                </div>
            </div>
            <div class="boss-rewards">
                <span class="reward-tag xp">âš¡ +500 XP</span>
                <span class="reward-tag gold">ðŸª™ +100 Oro</span>
                <span class="reward-tag item">ðŸŽ Cofre Ã‰pico</span>
            </div>
        </div>

        <div class="chat-container">
            <div class="chat-header">
                <span>ðŸ’¬</span> Chat de Party
            </div>
            <div class="chat-messages" id="chat-messages"></div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chat-input" placeholder="Escribir mensaje..." maxlength="100">
                <button class="chat-send" onclick="sendMessage()">âž¤</button>
            </div>
        </div>
    </section>

    <section id="shop-section" class="section">
        <h3 class="section-title">ðŸŽ Tienda de Recompensas</h3>
        <div class="shop-grid" id="shop-grid"></div>
    </section>

    <section id="stats-section" class="section">
        <h3 class="section-title">ðŸ“Š EstadÃ­sticas</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value-big" id="total-completed">0</div>
                <div class="stat-label-big">Misiones Completadas</div>
            </div>
            <div class="stat-card">
                <div class="stat-value-big" id="max-streak">0</div>
                <div class="stat-label-big">Racha MÃ¡xima</div>
            </div>
            <div class="stat-card">
                <div class="stat-value-big" id="current-level">1</div>
                <div class="stat-label-big">Nivel Actual</div>
            </div>
            <div class="stat-card">
                <div class="stat-value-big" id="total-xp">0</div>
                <div class="stat-label-big">XP Total</div>
            </div>
        </div>

        <h3 class="section-title">ðŸ† Logros Recientes</h3>
        <div class="achievements-list" id="achievements-list"></div>
    </section>

    <!-- PROFILE SECTION -->
    <section id="profile-section" class="section">
        <div class="profile-header">
            <div class="profile-avatar-large" onclick="openProfileEditModal()">
                <span id="profile-avatar-emoji">ðŸ§™â€â™‚ï¸</span>
                <div class="edit-overlay">âœï¸</div>
            </div>
            <h2 class="profile-name" id="profile-display-name">HÃ©roe</h2>
            <p class="profile-email" id="profile-display-email">jugador@lifequest.com</p>
            <div class="profile-stats-row">
                <div class="profile-stat">
                    <div class="profile-stat-value" id="profile-level">1</div>
                    <div class="profile-stat-label">Nivel</div>
                </div>
                <div class="profile-stat">
                    <div class="profile-stat-value" id="profile-xp">0</div>
                    <div class="profile-stat-label">XP Total</div>
                </div>
                <div class="profile-stat">
                    <div class="profile-stat-value" id="profile-joined">Hoy</div>
                    <div class="profile-stat-label">Miembro desde</div>
                </div>
            </div>
        </div>

        <div class="profile-menu">
            <div class="menu-item" onclick="openProfileEditModal()">
                <span class="menu-icon">âœï¸</span>
                <span class="menu-text">Editar Perfil</span>
                <span class="menu-arrow">â€º</span>
            </div>
            <div class="menu-item" onclick="showSection('stats')">
                <span class="menu-icon">ðŸ“Š</span>
                <span class="menu-text">Mis EstadÃ­sticas</span>
                <span class="menu-arrow">â€º</span>
            </div>
            <div class="menu-item" onclick="showSection('achievements-detail')">
                <span class="menu-icon">ðŸ†</span>
                <span class="menu-text">Logros Desbloqueados</span>
                <span class="menu-badge" id="achievements-count">0</span>
            </div>
            <div class="menu-item" onclick="exportData()">
                <span class="menu-icon">ðŸ’¾</span>
                <span class="menu-text">Exportar Datos</span>
                <span class="menu-arrow">â€º</span>
            </div>
            <div class="menu-item" onclick="confirmResetData()">
                <span class="menu-icon" style="color: var(--danger);">ðŸ—‘ï¸</span>
                <span class="menu-text" style="color: var(--danger);">Reiniciar Progreso</span>
            </div>
        </div>

        <div class="profile-achievements-preview">
            <h3 class="section-title">ðŸ† Ãšltimos Logros</h3>
            <div class="achievements-grid" id="profile-achievements-grid"></div>
        </div>
    </section>

    <!-- ACHIEVEMENTS DETAIL SECTION -->
    <section id="achievements-detail-section" class="section">
        <button class="back-btn" onclick="showSection('profile')">
            <span>â†</span> Volver al Perfil
        </button>
        
        <div class="achievements-detail-header">
            <h2 class="achievements-detail-title">ðŸ† Logros Desbloqueados</h2>
            <p style="color: #94a3b8; font-size: 0.9rem;">Colecciona los 161 logros disponibles</p>
            <div class="achievements-progress">
                <div class="achievements-progress-fill" id="achievements-progress-bar" style="width: 0%"></div>
            </div>
            <div class="achievements-count-text" id="achievements-progress-text">0 de 161 logros desbloqueados</div>
        </div>

        <div class="achievements-categories" id="achievements-categories">
            <!-- Categories will be rendered here -->
        </div>

        <div id="achievements-detail-list">
            <!-- Achievements will be rendered here -->
        </div>
    </section>

    <!-- NOTIFICATIONS SECTION -->
    <section id="notifications-section" class="section">
        <div class="notifications-header">
            <button class="back-btn" onclick="showSection('quests')" style="margin: 0; padding: 0.5rem 1rem;">
                <span>â†</span>
            </button>
            <h2>ðŸ”” Notificaciones</h2>
        </div>
        
        <button class="clear-all-btn" onclick="clearAllNotifications()" id="clear-all-btn" style="display: none;">
            ðŸ—‘ï¸ Limpiar todo
        </button>

        <div id="notifications-list">
            <!-- Notifications will be rendered here -->
        </div>
    </section>

    <button class="fab" onclick="openModal()">+</button>

    <div class="modal-overlay" id="quest-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">âš”ï¸ Nueva MisiÃ³n</h3>
                <button class="modal-close" onclick="closeModal()">Ã—</button>
            </div>
            <form onsubmit="addQuest(event)">
                <div class="form-group">
                    <label class="form-label">Nombre de la misiÃ³n</label>
                    <input type="text" class="form-input" id="quest-name" placeholder="Ej: Meditar 10 minutos" required maxlength="50">
                </div>
                
                <div class="form-group">
                    <label class="form-label">CategorÃ­a</label>
                    <select class="form-select" id="quest-category">
                        <option value="health">ðŸ’š Salud & Fitness</option>
                        <option value="work">ðŸ’¼ Trabajo & Productividad</option>
                        <option value="mind">ðŸ§˜ Mente & Crecimiento</option>
                        <option value="social">ðŸ¤ Social & Relaciones</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Dificultad</label>
                    <div class="difficulty-selector">
                        <button type="button" class="difficulty-btn" data-diff="1" onclick="setDiff(1)">
                            ðŸŸ¢<br>FÃ¡cil
                        </button>
                        <button type="button" class="difficulty-btn active" data-diff="2" onclick="setDiff(2)">
                            ðŸŸ¡<br>Medio
                        </button>
                        <button type="button" class="difficulty-btn" data-diff="3" onclick="setDiff(3)">
                            ðŸ”´<br>DifÃ­cil
                        </button>
                    </div>
                </div>

                <button type="submit" class="submit-btn">Crear MisiÃ³n</button>
            </form>
        </div>
    </div>

    <!-- Quest Edit Modal -->
    <div class="modal-overlay" id="quest-edit-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">âœï¸ Editar MisiÃ³n</h3>
                <button class="modal-close" onclick="closeQuestEditModal()">Ã—</button>
            </div>
            <form onsubmit="saveQuestEdit(event)">
                <input type="hidden" id="edit-quest-id">
                <input type="hidden" id="edit-quest-category">
                <div class="form-group">
                    <label class="form-label">Nombre de la misiÃ³n</label>
                    <input type="text" class="form-input" id="edit-quest-name" required maxlength="50">
                </div>
                
                <div class="form-group">
                    <label class="form-label">CategorÃ­a</label>
                    <select class="form-select" id="edit-quest-category-select">
                        <option value="health">ðŸ’š Salud & Fitness</option>
                        <option value="work">ðŸ’¼ Trabajo & Productividad</option>
                        <option value="mind">ðŸ§˜ Mente & Crecimiento</option>
                        <option value="social">ðŸ¤ Social & Relaciones</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Dificultad</label>
                    <div class="difficulty-selector">
                        <button type="button" class="difficulty-btn" data-edit-diff="1" onclick="setEditDiff(1)">
                            ðŸŸ¢<br>FÃ¡cil
                        </button>
                        <button type="button" class="difficulty-btn" data-edit-diff="2" onclick="setEditDiff(2)">
                            ðŸŸ¡<br>Medio
                        </button>
                        <button type="button" class="difficulty-btn" data-edit-diff="3" onclick="setEditDiff(3)">
                            ðŸ”´<br>DifÃ­cil
                        </button>
                    </div>
                </div>

                <div class="quest-edit-actions">
                    <button type="button" class="quest-edit-btn delete" onclick="confirmDeleteQuest()">
                        ðŸ—‘ï¸ Eliminar
                    </button>
                    <button type="submit" class="quest-edit-btn save">
                        ðŸ’¾ Guardar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Profile Registration/Edit Modal -->
    <div class="modal-overlay" id="profile-edit-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="profile-modal-title">ðŸ“ Completa tu Perfil</h3>
                <button class="modal-close" onclick="closeProfileEditModal()">Ã—</button>
            </div>
            <form onsubmit="saveProfileData(event)">
                <div class="form-group">
                    <label class="form-label">Nombre de hÃ©roe *</label>
                    <input type="text" class="form-input" id="profile-name-input" placeholder="Tu nombre" maxlength="20" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Email (opcional)</label>
                    <input type="email" class="form-input" id="profile-email-input" placeholder="tu@email.com">
                </div>

                <div class="form-group">
                    <label class="form-label">Tu avatar</label>
                    <div class="avatar-grid" id="edit-avatar-grid"></div>
                </div>

                <div class="form-group">
                    <label class="form-label">Preferencias</label>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>ðŸ””</span> Notificaciones diarias
                        </div>
                        <div class="toggle active" id="pref-notifications" onclick="togglePreference('notifications')">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-label">
                            <span>ðŸ”Š</span> Efectos de sonido
                        </div>
                        <div class="toggle active" id="pref-sounds" onclick="togglePreference('sounds')">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>

                <div class="form-info" id="profile-info-text" style="display: none;">
                    <p style="color: #94a3b8; font-size: 0.85rem; margin-bottom: 1rem;">
                        â„¹ï¸ Puedes editar estos datos cuando quieras desde tu perfil.
                    </p>
                </div>

                <button type="submit" class="submit-btn" id="profile-submit-btn">Guardar Perfil</button>
            </form>
        </div>
    </div>

    <div class="toast-container" id="toast-container"></div>

    <div class="levelup-overlay" id="levelup-overlay">
        <div class="levelup-text">Â¡SUBISTE DE NIVEL!</div>
        <div class="levelup-level" id="new-level">2</div>
        <p style="color: #94a3b8; margin-top: 1rem;">Nuevas habilidades desbloqueadas</p>
    </div>

    <nav class="bottom-nav">
        <a href="#" class="nav-item active" onclick="showSection('quests'); return false;">
            <span class="nav-icon">âš”ï¸</span>
            <span>Misiones</span>
        </a>
        <a href="#" class="nav-item" onclick="showSection('party'); return false;">
            <span class="nav-icon">ðŸ‘¥</span>
            <span>Party</span>
        </a>
        <a href="#" class="nav-item" onclick="showSection('shop'); return false;">
            <span class="nav-icon">ðŸŽ</span>
            <span>Tienda</span>
        </a>
        <a href="#" class="nav-item" onclick="showSection('profile'); return false;">
            <span class="nav-icon">ðŸ‘¤</span>
            <span>Perfil</span>
        </a>
    </nav>

    <script>
        // Extended avatars list - 16 options
        const avatars = ['ðŸ§™â€â™‚ï¸', 'âš”ï¸', 'ðŸ¹', 'ðŸ›¡ï¸', 'âš¡', 'ðŸ”¥', 'â„ï¸', 'ðŸŒŸ', 'ðŸ¦', 'ðŸ‰', 'ðŸ‘‘', 'ðŸ¦¸', 'ðŸ§â€â™€ï¸', 'ðŸ§›', 'ðŸ¤–', 'ðŸ‘½'];

        // 161 Achievements Database
        const achievementsDB = [
            // Primeros Pasos (Tutorial) - 7 logros
            { id: 1, name: 'Primeros Pasos', desc: 'Completa tu primera misiÃ³n', icon: 'ðŸ‘¶', category: 'Primeros Pasos', requirement: 1, type: 'quests_completed' },
            { id: 2, name: 'Apuntando Alto', desc: 'Completa 5 misiones', icon: 'ðŸŽ¯', category: 'Primeros Pasos', requirement: 5, type: 'quests_completed' },
            { id: 3, name: 'Estrella Naciente', desc: 'Alcanza nivel 5', icon: 'â­', category: 'Primeros Pasos', requirement: 5, type: 'level' },
            { id: 4, name: 'Equipado', desc: 'Compra tu primera recompensa', icon: 'ðŸŽ’', category: 'Primeros Pasos', requirement: 1, type: 'shop_buy' },
            { id: 5, name: 'Personalizado', desc: 'Edita tu perfil por primera vez', icon: 'ðŸ‘¤', category: 'Primeros Pasos', requirement: 1, type: 'profile_edit' },
            { id: 6, name: 'Conectado', desc: 'Activa las notificaciones', icon: 'ðŸ””', category: 'Primeros Pasos', requirement: 1, type: 'notifications_on' },
            { id: 7, name: 'Iniciado', desc: 'Abre la app 3 dÃ­as seguidos', icon: 'ðŸ“±', category: 'Primeros Pasos', requirement: 3, type: 'login_streak' },
            
            // Rachas y Consistencia - 10 logros
            { id: 8, name: 'Racha de Fuego', desc: '7 dÃ­as seguidos completando', icon: 'ðŸ”¥', category: 'Rachas', requirement: 7, type: 'daily_streak' },
            { id: 9, name: 'Racha ElÃ©ctrica', desc: '14 dÃ­as seguidos', icon: 'âš¡', category: 'Rachas', requirement: 14, type: 'daily_streak' },
            { id: 10, name: 'Racha Estelar', desc: '30 dÃ­as seguidos', icon: 'ðŸŒŸ', category: 'Rachas', requirement: 30, type: 'daily_streak' },
            { id: 11, name: 'Racha Diamante', desc: '60 dÃ­as seguidos', icon: 'ðŸ’Ž', category: 'Rachas', requirement: 60, type: 'daily_streak' },
            { id: 12, name: 'Racha Real', desc: '100 dÃ­as seguidos', icon: 'ðŸ‘‘', category: 'Rachas', requirement: 100, type: 'daily_streak' },
            { id: 13, name: 'Inquebrantable', desc: '365 dÃ­as seguidos', icon: 'ðŸ¦¸', category: 'Rachas', requirement: 365, type: 'daily_streak' },
            { id: 14, name: 'Puntual', desc: 'Completa misiones antes de las 9am por 7 dÃ­as', icon: 'â°', category: 'Rachas', requirement: 7, type: 'early_bird' },
            { id: 15, name: 'Nocturno', desc: 'Completa misiones despuÃ©s de las 9pm por 7 dÃ­as', icon: 'ðŸŒ™', category: 'Rachas', requirement: 7, type: 'night_owl' },
            { id: 16, name: 'Perfecto', desc: 'Completa TODAS las misiones diarias por 7 dÃ­as', icon: 'ðŸŽ¯', category: 'Rachas', requirement: 7, type: 'perfect_week' },
            { id: 17, name: 'Cien Por Ciento', desc: 'Completa TODAS las misiones por 30 dÃ­as', icon: 'ðŸ’¯', category: 'Rachas', requirement: 30, type: 'perfect_month' },
            
            // Salud y Fitness - 15 logros
            { id: 18, name: 'Hidratado', desc: 'Bebe 2L de agua por 7 dÃ­as', icon: 'ðŸ’§', category: 'Salud', requirement: 7, type: 'health_streak' },
            { id: 19, name: 'Corredor', desc: 'Ejercicio 30 min por 7 dÃ­as', icon: 'ðŸƒ', category: 'Salud', requirement: 7, type: 'exercise_streak' },
            { id: 20, name: 'Fortaleza', desc: 'Ejercicio 30 min por 30 dÃ­as', icon: 'ðŸ’ª', category: 'Salud', requirement: 30, type: 'exercise_streak' },
            { id: 21, name: 'NutriciÃ³n', desc: 'Come saludable por 7 dÃ­as', icon: 'ðŸ¥—', category: 'Salud', requirement: 7, type: 'nutrition_streak' },
            { id: 22, name: 'Descansado', desc: 'Duerme 8 horas por 7 dÃ­as', icon: 'ðŸ˜´', category: 'Salud', requirement: 7, type: 'sleep_streak' },
            { id: 23, name: 'Zen', desc: 'MeditaciÃ³n por 7 dÃ­as seguidos', icon: 'ðŸ§˜', category: 'Salud', requirement: 7, type: 'meditation_streak' },
            { id: 24, name: 'Caminante', desc: '10,000 pasos diarios por 7 dÃ­as', icon: 'ðŸš¶', category: 'Salud', requirement: 7, type: 'steps_streak' },
            { id: 25, name: 'Levantador', desc: 'Entrenamiento de fuerza por 14 dÃ­as', icon: 'ðŸ‹ï¸', category: 'Salud', requirement: 14, type: 'strength_streak' },
            { id: 26, name: 'Maestro Zen', desc: 'MeditaciÃ³n por 30 dÃ­as seguidos', icon: 'ðŸ§˜â€â™€ï¸', category: 'Salud', requirement: 30, type: 'meditation_streak' },
            { id: 27, name: 'Vegano', desc: 'Come vegetariano por 14 dÃ­as', icon: 'ðŸ¥¦', category: 'Salud', requirement: 14, type: 'vegetarian_streak' },
            { id: 28, name: 'Saludable', desc: 'Toma vitaminas por 30 dÃ­as', icon: 'ðŸ’Š', category: 'Salud', requirement: 30, type: 'vitamins_streak' },
            { id: 29, name: 'Sonrisa', desc: 'Higiene dental perfecta por 30 dÃ­as', icon: 'ðŸ¦·', category: 'Salud', requirement: 30, type: 'dental_streak' },
            { id: 30, name: 'Ciclista', desc: 'Bicicleta 3 veces por semana durante 4 semanas', icon: 'ðŸš´', category: 'Salud', requirement: 12, type: 'cycling_count' },
            { id: 31, name: 'Nadador', desc: 'Nada 2 veces por semana durante 4 semanas', icon: 'ðŸŠ', category: 'Salud', requirement: 8, type: 'swimming_count' },
            { id: 32, name: 'Escalador', desc: 'Escalada 4 veces en un mes', icon: 'ðŸ§—', category: 'Salud', requirement: 4, type: 'climbing_count' },
            
            // Productividad y Trabajo - 15 logros
            { id: 33, name: 'Profesional', desc: 'Deep work 2h por 5 dÃ­as', icon: 'ðŸ’¼', category: 'Productividad', requirement: 5, type: 'deep_work_streak' },
            { id: 34, name: 'Productivo', desc: 'Deep work 2h por 30 dÃ­as', icon: 'ðŸš€', category: 'Productividad', requirement: 30, type: 'deep_work_streak' },
            { id: 35, name: 'Bandeja Cero', desc: 'Limpia tu email por 5 dÃ­as', icon: 'ðŸ“§', category: 'Productividad', requirement: 5, type: 'inbox_zero_streak' },
            { id: 36, name: 'Organizado', desc: 'Planifica tu dÃ­a por 14 dÃ­as', icon: 'ðŸ“', category: 'Productividad', requirement: 14, type: 'planning_streak' },
            { id: 37, name: 'Aprendiz', desc: 'Estudia 1h por 14 dÃ­as', icon: 'ðŸŽ“', category: 'Productividad', requirement: 14, type: 'study_streak' },
            { id: 38, name: 'Erudito', desc: 'Lee 30 min por 30 dÃ­as', icon: 'ðŸ“š', category: 'Productividad', requirement: 30, type: 'reading_streak' },
            { id: 39, name: 'Programador', desc: 'Codifica 1h por 14 dÃ­as', icon: 'ðŸ’»', category: 'Productividad', requirement: 14, type: 'coding_streak' },
            { id: 40, name: 'Creativo', desc: 'Trabajo creativo por 14 dÃ­as', icon: 'ðŸŽ¨', category: 'Productividad', requirement: 14, type: 'creative_streak' },
            { id: 41, name: 'AnalÃ­tico', desc: 'AnÃ¡lisis de datos por 7 dÃ­as', icon: 'ðŸ“Š', category: 'Productividad', requirement: 7, type: 'analysis_streak' },
            { id: 42, name: 'Networker', desc: 'Contacto profesional por 7 dÃ­as', icon: 'ðŸ¤', category: 'Productividad', requirement: 7, type: 'networking_streak' },
            { id: 43, name: 'Innovador', desc: 'Idea nueva implementada', icon: 'ðŸ’¡', category: 'Productividad', requirement: 1, type: 'innovation_count' },
            { id: 44, name: 'Eficiente', desc: 'Completa tareas antes de tiempo por 7 dÃ­as', icon: 'â±ï¸', category: 'Productividad', requirement: 7, type: 'efficiency_streak' },
            { id: 45, name: 'Enfocado', desc: 'Sin distracciones por 4h, 7 dÃ­as seguidos', icon: 'ðŸŽ¯', category: 'Productividad', requirement: 7, type: 'focus_streak' },
            { id: 46, name: 'Ascenso', desc: 'Completa un proyecto grande', icon: 'ðŸ“ˆ', category: 'Productividad', requirement: 1, type: 'project_complete' },
            { id: 47, name: 'Empleado del Mes', desc: 'Productividad mÃ¡xima por 30 dÃ­as', icon: 'ðŸ†', category: 'Productividad', requirement: 30, type: 'productivity_streak' },
            
            // Mente y Crecimiento Personal - 15 logros
            { id: 48, name: 'Lector', desc: 'Lee 20 pÃ¡ginas por 14 dÃ­as', icon: 'ðŸ“–', category: 'Mente', requirement: 14, type: 'pages_streak' },
            { id: 49, name: 'Escritor', desc: 'Escribe 500 palabras por 14 dÃ­as', icon: 'âœï¸', category: 'Mente', requirement: 14, type: 'writing_streak' },
            { id: 50, name: 'MelodÃ­a', desc: 'PrÃ¡ctica musical por 14 dÃ­as', icon: 'ðŸŽµ', category: 'Mente', requirement: 14, type: 'music_streak' },
            { id: 51, name: 'Orador', desc: 'PrÃ¡ctica de hablar en pÃºblico', icon: 'ðŸ—£ï¸', category: 'Mente', requirement: 10, type: 'speaking_count' },
            { id: 52, name: 'Mentalidad', desc: 'VisualizaciÃ³n positiva por 21 dÃ­as', icon: 'ðŸ§ ', category: 'Mente', requirement: 21, type: 'visualization_streak' },
            { id: 53, name: 'Actor', desc: 'ActÃºa fuera de tu zona de confort', icon: 'ðŸŽ­', category: 'Mente', requirement: 5, type: 'comfort_zone_count' },
            { id: 54, name: 'Crecimiento', desc: 'Nueva habilidad aprendida', icon: 'ðŸŒ±', category: 'Mente', requirement: 1, type: 'skill_learned' },
            { id: 55, name: 'Equilibrio', desc: 'MeditaciÃ³n y ejercicio mismo dÃ­a por 14 dÃ­as', icon: 'ðŸŽª', category: 'Mente', requirement: 14, type: 'balance_streak' },
            { id: 56, name: 'Sabio', desc: 'Lee 1 libro por semana durante 4 semanas', icon: 'ðŸ¦‰', category: 'Mente', requirement: 4, type: 'books_count' },
            { id: 57, name: 'Graduado', desc: 'Completa un curso online', icon: 'ðŸŽ“', category: 'Mente', requirement: 1, type: 'course_complete' },
            { id: 58, name: 'Explorador', desc: 'Aprende sobre un nuevo tema por 30 dÃ­as', icon: 'ðŸ—ºï¸', category: 'Mente', requirement: 30, type: 'explore_streak' },
            { id: 59, name: 'CientÃ­fico', desc: 'Experimento o proyecto DIY completado', icon: 'ðŸ”¬', category: 'Mente', requirement: 1, type: 'experiment_count' },
            { id: 60, name: 'Artista', desc: 'Crea arte por 21 dÃ­as', icon: 'ðŸŽ¨', category: 'Mente', requirement: 21, type: 'art_streak' },
            { id: 61, name: 'FotÃ³grafo', desc: 'Toma 1 foto creativa diaria por 30 dÃ­as', icon: 'ðŸ“¸', category: 'Mente', requirement: 30, type: 'photo_streak' },
            { id: 62, name: 'Director', desc: 'Crea contenido/video por 14 dÃ­as', icon: 'ðŸŽ¬', category: 'Mente', requirement: 14, type: 'content_streak' },
            
            // Social y Relaciones - 15 logros
            { id: 63, name: 'Sociable', desc: 'Contacto con amigo por 7 dÃ­as', icon: 'ðŸ‘‹', category: 'Social', requirement: 7, type: 'friend_streak' },
            { id: 64, name: 'RomÃ¡ntico', desc: 'Cita o gesto de amor por 14 dÃ­as', icon: 'ðŸ’‘', category: 'Social', requirement: 14, type: 'romance_streak' },
            { id: 65, name: 'Familiar', desc: 'Llamada familiar por 14 dÃ­as', icon: 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§', category: 'Social', requirement: 14, type: 'family_streak' },
            { id: 66, name: 'Generoso', desc: 'Acto de bondad por 14 dÃ­as', icon: 'ðŸ¤—', category: 'Social', requirement: 14, type: 'kindness_streak' },
            { id: 67, name: 'Comunicador', desc: 'ConversaciÃ³n profunda por 7 dÃ­as', icon: 'ðŸ’¬', category: 'Social', requirement: 7, type: 'deep_talk_streak' },
            { id: 68, name: 'Detallista', desc: 'Regalo o sorpresa por 7 dÃ­as', icon: 'ðŸŽ', category: 'Social', requirement: 7, type: 'gift_streak' },
            { id: 69, name: 'AnfitriÃ³n', desc: 'Cena/encuentro social por 4 semanas', icon: 'ðŸ½ï¸', category: 'Social', requirement: 4, type: 'host_count' },
            { id: 70, name: 'Mentor', desc: 'Ayuda a alguien por 14 dÃ­as', icon: 'ðŸ¤', category: 'Social', requirement: 14, type: 'mentor_streak' },
            { id: 71, name: 'LÃ­der', desc: 'Lidera un grupo o proyecto', icon: 'ðŸ‘¥', category: 'Social', requirement: 1, type: 'leadership_count' },
            { id: 72, name: 'Networker Pro', desc: '5 nuevos contactos en un mes', icon: 'ðŸŒ', category: 'Social', requirement: 5, type: 'new_contacts' },
            { id: 73, name: 'Carta', desc: 'Escribe cartas/manuscritos por 7 dÃ­as', icon: 'ðŸ’Œ', category: 'Social', requirement: 7, type: 'letter_streak' },
            { id: 74, name: 'Celebrador', desc: 'Organiza evento para otros', icon: 'ðŸŽ‰', category: 'Social', requirement: 1, type: 'event_host' },
            { id: 75, name: 'Agradecido', desc: 'Expresa gratitud por 30 dÃ­as', icon: 'ðŸ™', category: 'Social', requirement: 30, type: 'gratitude_streak' },
            { id: 76, name: 'Oyente', desc: 'Escucha activamente por 14 dÃ­as', icon: 'ðŸ‘‚', category: 'Social', requirement: 14, type: 'listening_streak' },
            { id: 77, name: 'Amoroso', desc: 'Dile \"te quiero\" a alguien por 30 dÃ­as', icon: 'â¤ï¸', category: 'Social', requirement: 30, type: 'love_streak' },
            
            // Hogar y OrganizaciÃ³n - 14 logros
            { id: 78, name: 'Limpio', desc: 'Limpieza diaria por 7 dÃ­as', icon: 'ðŸ§¹', category: 'Hogar', requirement: 7, type: 'cleaning_streak' },
            { id: 79, name: 'Chef', desc: 'Cocina en casa por 14 dÃ­as', icon: 'ðŸ³', category: 'Hogar', requirement: 14, type: 'cooking_streak' },
            { id: 80, name: 'Jardinero', desc: 'Cuida plantas por 30 dÃ­as', icon: 'ðŸŒ¿', category: 'Hogar', requirement: 30, type: 'gardening_streak' },
            { id: 81, name: 'Paseador', desc: 'Pasea mascota por 30 dÃ­as', icon: 'ðŸ•', category: 'Hogar', requirement: 30, type: 'dog_walk_streak' },
            { id: 82, name: 'Organizado', desc: 'LavanderÃ­a y organizaciÃ³n por 14 dÃ­as', icon: 'ðŸ§º', category: 'Hogar', requirement: 14, type: 'laundry_streak' },
            { id: 83, name: 'Manitas', desc: 'Proyecto DIY por 4 semanas', icon: 'ðŸ› ï¸', category: 'Hogar', requirement: 4, type: 'diy_count' },
            { id: 84, name: 'Ahorrador', desc: 'Registra gastos por 30 dÃ­as', icon: 'ðŸ’°', category: 'Hogar', requirement: 30, type: 'expense_tracking' },
            { id: 85, name: 'Planificador', desc: 'Presupuesto mensual cumplido', icon: 'ðŸ“', category: 'Hogar', requirement: 1, type: 'budget_met' },
            { id: 86, name: 'EcolÃ³gico', desc: 'Recicla por 30 dÃ­as', icon: 'â™»ï¸', category: 'Hogar', requirement: 30, type: 'recycling_streak' },
            { id: 87, name: 'Eficiente', desc: 'Reduce consumo energÃ©tico', icon: 'ðŸ’¡', category: 'Hogar', requirement: 1, type: 'energy_save' },
            { id: 88, name: 'Comprador Inteligente', desc: 'Lista de compras por 4 semanas', icon: 'ðŸ›’', category: 'Hogar', requirement: 4, type: 'shopping_list_streak' },
            { id: 89, name: 'Meal Prep', desc: 'Prepara comidas por 14 dÃ­as', icon: 'ðŸ±', category: 'Hogar', requirement: 14, type: 'meal_prep_streak' },
            { id: 90, name: 'Brillante', desc: 'Limpieza profunda mensual por 3 meses', icon: 'ðŸ§½', category: 'Hogar', requirement: 3, type: 'deep_clean_count' },
            { id: 91, name: 'DueÃ±o', desc: 'Mantenimiento hogar por 30 dÃ­as', icon: 'ðŸ ', category: 'Hogar', requirement: 30, type: 'maintenance_streak' },
            
            // Riqueza y EconomÃ­a - 10 logros
            { id: 92, name: 'Ahorrista', desc: 'Ahorra 10% ingresos por 3 meses', icon: 'ðŸ’µ', category: 'Riqueza', requirement: 3, type: 'saving_streak' },
            { id: 93, name: 'Inversionista', desc: 'Primera inversiÃ³n', icon: 'ðŸ’Ž', category: 'Riqueza', requirement: 1, type: 'first_investment' },
            { id: 94, name: 'Banquero', desc: 'Saldo positivo creciente por 6 meses', icon: 'ðŸ¦', category: 'Riqueza', requirement: 6, type: 'positive_balance' },
            { id: 95, name: 'Libre', desc: 'Paga deuda', icon: 'ðŸ’³', category: 'Riqueza', requirement: 1, type: 'debt_free' },
            { id: 96, name: 'Trader', desc: 'InversiÃ³n rentable', icon: 'ðŸ“ˆ', category: 'Riqueza', requirement: 1, type: 'profitable_trade' },
            { id: 97, name: 'Meta', desc: 'Alcanza meta de ahorro', icon: 'ðŸŽ¯', category: 'Riqueza', requirement: 1, type: 'savings_goal' },
            { id: 98, name: 'Millonario', desc: 'Acumula 1000 de oro', icon: 'ðŸ’°', category: 'Riqueza', requirement: 1000, type: 'gold_1000' },
            { id: 99, name: 'Magnate', desc: 'Acumula 5000 de oro', icon: 'ðŸ†', category: 'Riqueza', requirement: 5000, type: 'gold_5000' },
            { id: 100, name: 'Emperador', desc: 'Acumula 10000 de oro', icon: 'ðŸ‘‘', category: 'Riqueza', requirement: 10000, type: 'gold_10000' },
            { id: 101, name: 'Analista', desc: 'RevisiÃ³n financiera mensual por 6 meses', icon: 'ðŸ“Š', category: 'Riqueza', requirement: 6, type: 'finance_review' },
            
            // Party y Social (Multiplayer) - 10 logros
            { id: 102, name: 'Party Animal', desc: 'Ãšnete a una party', icon: 'ðŸ‘¥', category: 'Party', requirement: 1, type: 'join_party' },
            { id: 103, name: 'Cooperativo', desc: 'Completa misiÃ³n con party', icon: 'ðŸ¤', category: 'Party', requirement: 5, type: 'party_quests' },
            { id: 104, name: 'Cazador', desc: 'Derrota 1 jefe semanal', icon: 'ðŸ‘¹', category: 'Party', requirement: 1, type: 'boss_defeat' },
            { id: 105, name: 'Guerrero', desc: 'Derrota 5 jefes', icon: 'âš”ï¸', category: 'Party', requirement: 5, type: 'boss_defeat_count' },
            { id: 106, name: 'CampeÃ³n', desc: 'Derrota 10 jefes', icon: 'ðŸ†', category: 'Party', requirement: 10, type: 'boss_defeat_count' },
            { id: 107, name: 'Social', desc: 'EnvÃ­a 50 mensajes en chat', icon: 'ðŸ’¬', category: 'Party', requirement: 50, type: 'chat_messages' },
            { id: 108, name: 'LÃ­der de Party', desc: 'SÃ© lÃ­der por 30 dÃ­as', icon: 'ðŸŽ–ï¸', category: 'Party', requirement: 30, type: 'leader_streak' },
            { id: 109, name: 'MVP', desc: 'Mayor daÃ±o a jefe 3 veces', icon: 'ðŸŒŸ', category: 'Party', requirement: 3, type: 'mvp_count' },
            { id: 110, name: 'Apoyo', desc: 'Motiva a compaÃ±ero 10 veces', icon: 'ðŸ¤—', category: 'Party', requirement: 10, type: 'support_count' },
            { id: 111, name: 'Veterano', desc: '30 dÃ­as en party', icon: 'ðŸ…', category: 'Party', requirement: 30, type: 'party_streak' },
            
            // Eventos Especiales y Temporada - 10 logros
            { id: 112, name: 'Festivo', desc: 'Completa misiones durante Navidad', icon: 'ðŸŽ„', category: 'Eventos', requirement: 7, type: 'christmas_quests' },
            { id: 113, name: 'Espeluznante', desc: 'Halloween productivo', icon: 'ðŸŽƒ', category: 'Eventos', requirement: 7, type: 'halloween_quests' },
            { id: 114, name: 'AÃ±o Nuevo', desc: 'Metas de aÃ±o nuevo cumplidas', icon: 'ðŸŽ†', category: 'Eventos', requirement: 1, type: 'new_year_goal' },
            { id: 115, name: 'RomÃ¡ntico', desc: 'San ValentÃ­n especial', icon: 'ðŸ’˜', category: 'Eventos', requirement: 1, type: 'valentine_quest' },
            { id: 116, name: 'Gratitud', desc: 'AcciÃ³n de gracias', icon: 'ðŸ¦ƒ', category: 'Eventos', requirement: 1, type: 'thanksgiving_quest' },
            { id: 117, name: 'Primavera', desc: 'RenovaciÃ³n de primavera', icon: 'ðŸŒ¸', category: 'Eventos', requirement: 30, type: 'spring_streak' },
            { id: 118, name: 'Verano', desc: 'Productividad de verano', icon: 'â˜€ï¸', category: 'Eventos', requirement: 30, type: 'summer_streak' },
            { id: 119, name: 'OtoÃ±o', desc: 'Cosecha de logros', icon: 'ðŸ‚', category: 'Eventos', requirement: 30, type: 'autumn_streak' },
            { id: 120, name: 'Invierno', desc: 'Resistencia invernal', icon: 'â„ï¸', category: 'Eventos', requirement: 30, type: 'winter_streak' },
            { id: 121, name: 'CumpleaÃ±os', desc: 'CumpleaÃ±os productivo', icon: 'ðŸŽ‚', category: 'Eventos', requirement: 1, type: 'birthday_quest' },
            
            // MaestrÃ­a y ColecciÃ³n - 10 logros
            { id: 122, name: 'Cazador de Logros', desc: 'Desbloquea 50 logros', icon: 'ðŸ†', category: 'MaestrÃ­a', requirement: 50, type: 'achievements_count' },
            { id: 123, name: 'Coleccionista', desc: 'Desbloquea 100 logros', icon: 'ðŸŽ¯', category: 'MaestrÃ­a', requirement: 100, type: 'achievements_count' },
            { id: 124, name: 'Completista', desc: 'Desbloquea TODOS los logros', icon: 'ðŸ’Ž', category: 'MaestrÃ­a', requirement: 161, type: 'achievements_count' },
            { id: 125, name: 'Veterano', desc: 'Alcanza nivel 50', icon: 'â­', category: 'MaestrÃ­a', requirement: 50, type: 'level' },
            { id: 126, name: 'Legendario', desc: 'Alcanza nivel 100', icon: 'ðŸŒŸ', category: 'MaestrÃ­a', requirement: 100, type: 'level' },
            { id: 127, name: 'Inmortal', desc: 'Alcanza nivel 999', icon: 'ðŸ‘‘', category: 'MaestrÃ­a', requirement: 999, type: 'level' },
            { id: 128, name: 'Maestro', desc: 'Domina todas las categorÃ­as', icon: 'ðŸŽ–ï¸', category: 'MaestrÃ­a', requirement: 1, type: 'master_all' },
            { id: 129, name: 'Icono', desc: 'SÃ© un ejemplo para otros', icon: 'ðŸ…', category: 'MaestrÃ­a', requirement: 1, type: 'role_model' },
            { id: 130, name: 'HÃ©roe', desc: 'Impacto positivo en comunidad', icon: 'ðŸ¦¸', category: 'MaestrÃ­a', requirement: 1, type: 'community_impact' },
            { id: 131, name: 'Superestrella', desc: 'Reconocimiento global', icon: 'ðŸŒŸ', category: 'MaestrÃ­a', requirement: 1, type: 'global_recognition' },
            
            // DesafÃ­os Extremos - 10 logros
            { id: 132, name: 'Imposible', desc: '100 dÃ­as perfectos', icon: 'ðŸ”¥', category: 'Extremos', requirement: 100, type: 'perfect_days' },
            { id: 133, name: 'RelÃ¡mpago', desc: 'Completa 10 misiones en 1 dÃ­a', icon: 'âš¡', category: 'Extremos', requirement: 10, type: 'quests_one_day' },
            { id: 134, name: 'Insomne', desc: 'Productividad 24h', icon: 'ðŸŒ™', category: 'Extremos', requirement: 1, type: '24h_productive' },
            { id: 135, name: 'HÃ©rcules', desc: '30 dÃ­as de ejercicio intenso', icon: 'ðŸ’ª', category: 'Extremos', requirement: 30, type: 'intense_exercise' },
            { id: 136, name: 'Einstein', desc: 'Estudia 8h por 7 dÃ­as', icon: 'ðŸ§ ', category: 'Extremos', requirement: 7, type: 'study_marathon' },
            { id: 137, name: 'Rockefeller', desc: '10000 de oro sin gastar', icon: 'ðŸ’°', category: 'Extremos', requirement: 10000, type: 'gold_hoarder' },
            { id: 138, name: 'Maratonista', desc: 'Corre 5K diario por 30 dÃ­as', icon: 'ðŸƒ', category: 'Extremos', requirement: 30, type: 'run_5k_streak' },
            { id: 139, name: 'Bibliotecario', desc: 'Lee 5 libros en 1 mes', icon: 'ðŸ“š', category: 'Extremos', requirement: 5, type: 'books_month' },
            { id: 140, name: 'PrecisiÃ³n', desc: '100% precisiÃ³n por 30 dÃ­as', icon: 'ðŸŽ¯', category: 'Extremos', requirement: 30, type: 'accuracy_streak' },
            { id: 141, name: 'SuperhÃ©roe', desc: 'Haz todo perfecto por 7 dÃ­as', icon: 'ðŸ¦¸', category: 'Extremos', requirement: 7, type: 'superhero_week' },
            
            // Curiosidades y Divertidos - 10 logros
            { id: 142, name: 'ArcoÃ­ris', desc: 'Completa misiones de 5 colores diferentes', icon: 'ðŸŒˆ', category: 'Divertidos', requirement: 5, type: 'color_variety' },
            { id: 143, name: 'Aventurero', desc: 'Deja que el azar decida tu misiÃ³n', icon: 'ðŸŽ²', category: 'Divertidos', requirement: 7, type: 'random_quest' },
            { id: 144, name: 'Misterioso', desc: 'MisiÃ³n secreta completada', icon: 'ðŸŽ­', category: 'Divertidos', requirement: 1, type: 'secret_quest' },
            { id: 145, name: 'Circo', desc: 'Equilibra 5 categorÃ­as en 1 dÃ­a', icon: 'ðŸŽª', category: 'Divertidos', requirement: 1, type: 'balance_categories' },
            { id: 146, name: 'Arte', desc: 'MisiÃ³n creativa Ãºnica', icon: 'ðŸŽ¨', category: 'Divertidos', requirement: 1, type: 'unique_creative' },
            { id: 147, name: 'SinfonÃ­a', desc: 'MisiÃ³n con mÃºsica', icon: 'ðŸŽµ', category: 'Divertidos', requirement: 1, type: 'music_mission' },
            { id: 148, name: 'Luna', desc: 'MisiÃ³n nocturna especial', icon: 'ðŸŒ™', category: 'Divertidos', requirement: 1, type: 'night_mission' },
            { id: 149, name: 'Sol', desc: 'MisiÃ³n matutina 30 dÃ­as', icon: 'â˜€ï¸', category: 'Divertidos', requirement: 30, type: 'morning_streak' },
            { id: 150, name: 'Ola', desc: 'Ritmo perfecto por 21 dÃ­as', icon: 'ðŸŒŠ', category: 'Divertidos', requirement: 21, type: 'rhythm_streak' },
            { id: 151, name: 'Futuro', desc: 'PlanificaciÃ³n a largo plazo', icon: 'ðŸ”®', category: 'Divertidos', requirement: 1, type: 'long_term_plan' },
            
            // Anti-ProcrastinaciÃ³n - 10 logros
            { id: 152, name: 'Rana', desc: 'Come la rana primero (tarea difÃ­cil)', icon: 'ðŸ¸', category: 'Anti-ProcrastinaciÃ³n', requirement: 7, type: 'eat_frog' },
            { id: 153, name: '2 Minutos', desc: 'Regla de los 2 minutos por 14 dÃ­as', icon: 'â°', category: 'Anti-ProcrastinaciÃ³n', requirement: 14, type: 'two_minute_rule' },
            { id: 154, name: 'Sin Excusas', desc: 'Sin procrastinar por 7 dÃ­as', icon: 'ðŸš«', category: 'Anti-ProcrastinaciÃ³n', requirement: 7, type: 'no_excuses' },
            { id: 155, name: 'Ahora', desc: 'Tarea inmediata por 21 dÃ­as', icon: 'âš¡', category: 'Anti-ProcrastinaciÃ³n', requirement: 21, type: 'do_it_now' },
            { id: 156, name: 'Enfoque', desc: 'Sin redes sociales por 4h, 7 dÃ­as', icon: 'ðŸŽ¯', category: 'Anti-ProcrastinaciÃ³n', requirement: 7, type: 'no_social_media' },
            { id: 157, name: 'Disciplina', desc: 'Sin distracciones por 30 dÃ­as', icon: 'ðŸ”’', category: 'Anti-ProcrastinaciÃ³n', requirement: 30, type: 'no_distractions' },
            { id: 158, name: 'Desconectado', desc: 'Modo aviÃ³n productivo por 14 dÃ­as', icon: 'ðŸ“µ', category: 'Anti-ProcrastinaciÃ³n', requirement: 14, type: 'airplane_mode' },
            { id: 159, name: 'Equilibrista', desc: 'MÃºltiples proyectos avanzando', icon: 'ðŸŽª', category: 'Anti-ProcrastinaciÃ³n', requirement: 1, type: 'multiple_projects' },
            { id: 160, name: 'Sprint', desc: 'TÃ©cnica pomodoro por 30 dÃ­as', icon: 'ðŸƒ', category: 'Anti-ProcrastinaciÃ³n', requirement: 30, type: 'pomodoro_streak' },
            { id: 161, name: 'Anti-Pereza', desc: 'Vence la procrastinaciÃ³n 30 dÃ­as', icon: 'ðŸ¦¸', category: 'Anti-ProcrastinaciÃ³n', requirement: 30, type: 'anti_laziness' }
        ];

        // Game State
        let gameState = {
            user: {
                name: 'HÃ©roe',
                level: 1,
                xp: 0,
                xpToNext: 100,
                gold: 100,
                hp: 100,
                maxHp: 100,
                streak: 0,
                avatar: 'ðŸ§™â€â™‚ï¸',
                totalCompleted: 0,
                totalXp: 0,
                settings: {
                    notifications: true,
                    sounds: true
                },
                lastLogin: null,
                currentStreak: 0,
                longestStreak: 0,
                lastResetDate: null
            },
            party: {
                code: 'XP7-9Q2',
                members: [
                    { id: 1, name: 'TÃº', level: 1, avatar: 'ðŸ§™â€â™‚ï¸', isYou: true, isLeader: true, status: 'online' },
                    { id: 2, name: 'MarÃ­a', level: 3, avatar: 'âš”ï¸', isYou: false, isLeader: false, status: 'online' },
                    { id: 3, name: 'Carlos', level: 2, avatar: 'ðŸ¹', isYou: false, isLeader: false, status: 'away' }
                ],
                boss: {
                    name: 'ProcrastinaciÃ³n Suprema',
                    hp: 750,
                    maxHp: 1000,
                    level: 5
                },
                chat: [
                    { author: 'MarÃ­a', avatar: 'âš”ï¸', text: 'Â¡Vamos equipo! ðŸ’ª', time: '10:30' },
                    { author: 'Carlos', avatar: 'ðŸ¹', text: 'Ya hice 2 misiones hoy', time: '10:35' },
                    { author: 'Sistema', avatar: 'ðŸ¤–', text: 'El jefe estÃ¡ al 75% de HP', time: '10:40', isSystem: true }
                ]
            },
            quests: {
                health: [
                    { id: 1, title: 'Beber 2L de agua', difficulty: 2, completed: false, streak: 3, xp: 20, gold: 5, lastCompleted: null },
                    { id: 2, title: 'Ejercicio 30 minutos', difficulty: 3, completed: false, streak: 5, xp: 35, gold: 10, lastCompleted: null }
                ],
                work: [
                    { id: 3, title: 'Deep Work 2 horas', difficulty: 3, completed: false, streak: 2, xp: 40, gold: 12, lastCompleted: null }
                ],
                mind: [
                    { id: 4, title: 'Meditar 10 minutos', difficulty: 2, completed: false, streak: 7, xp: 25, gold: 6, lastCompleted: null }
                ],
                social: [
                    { id: 5, title: 'Llamar a un familiar', difficulty: 2, completed: false, streak: 1, xp: 30, gold: 8, lastCompleted: null }
                ]
            },
            shop: [
                { id: 1, name: 'Netflix 1h', icon: 'ðŸ“º', cost: 50, desc: 'Ver episodio de serie favorita' },
                { id: 2, name: 'Pizza Saludable', icon: 'ðŸ•', cost: 100, desc: 'Pedir comida favorita' },
                { id: 3, name: 'Libro Nuevo', icon: 'ðŸ“š', cost: 200, desc: 'Comprar libro deseado' },
                { id: 4, name: 'Gaming 1h', icon: 'ðŸŽ®', cost: 40, desc: 'Jugar videojuegos' },
                { id: 5, name: 'DÃ­a de Spa', icon: 'ðŸ›', cost: 150, desc: 'BaÃ±o relajante + skincare' },
                { id: 6, name: 'CafÃ© Especial', icon: 'â˜•', cost: 30, desc: 'Tomar cafÃ© en cafeterÃ­a' }
            ],
            achievements: JSON.parse(JSON.stringify(achievementsDB)),
            notifications: [],
            stats: {
                questsByCategory: { health: 0, work: 0, mind: 0, social: 0 },
                totalQuestsCreated: 5,
                perfectDays: 0,
                currentPerfectDayStreak: 0
            }
        };

        let selectedDifficulty = 2;
        let editDifficulty = 2;
        let tempAvatar = 'ðŸ§™â€â™‚ï¸';
        let isFirstTime = false;
        let currentEditingQuest = null;
        let confirmCallback = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadGame();
            checkDailyReset();
            checkFirstTime();
            renderAll();
            updateStats();
            setupChatInput();
            requestNotificationPermission();
            setInterval(checkReminders, 60000);
            setInterval(checkDailyReset, 60000); // Check every minute for reset
        });

        // Daily Reset System
        function checkDailyReset() {
            const now = new Date();
            const lastReset = gameState.user.lastResetDate ? new Date(gameState.user.lastResetDate) : null;
            
            // Check if it's past 5:00 AM and we haven't reset today
            const today5AM = new Date(now);
            today5AM.setHours(5, 0, 0, 0);
            
            if (!lastReset || lastReset < today5AM && now >= today5AM) {
                performDailyReset();
            }
        }

        function performDailyReset() {
            const now = new Date();
            gameState.user.lastResetDate = now.toISOString();
            
            // Check if all quests were completed yesterday for streak
            const allCompleted = Object.values(gameState.quests).every(cat => 
                cat.every(q => q.completed)
            );
            
            if (allCompleted) {
                gameState.user.currentStreak++;
                if (gameState.user.currentStreak > gameState.user.longestStreak) {
                    gameState.user.longestStreak = gameState.user.currentStreak;
                }
                gameState.stats.currentPerfectDayStreak++;
                if (gameState.stats.currentPerfectDayStreak > gameState.stats.perfectDays) {
                    gameState.stats.perfectDays = gameState.stats.currentPerfectDayStreak;
                }
                addNotification('ðŸ”¥ Racha Continuada', `Â¡Llevas ${gameState.user.currentStreak} dÃ­as perfectos!`, 'ðŸ”¥');
            } else {
                if (gameState.user.currentStreak > 0) {
                    addNotification('ðŸ’” Racha Perdida', `Tu racha de ${gameState.user.currentStreak} dÃ­as se ha reiniciado`, 'ðŸ’”');
                }
                gameState.user.currentStreak = 0;
                gameState.stats.currentPerfectDayStreak = 0;
            }
            
            // Reset all quests
            Object.keys(gameState.quests).forEach(category => {
                gameState.quests[category].forEach(quest => {
                    if (quest.completed) {
                        quest.streak++;
                    } else {
                        quest.streak = 0;
                    }
                    quest.completed = false;
                    quest.lastCompleted = null;
                });
            });
            
            addNotification('ðŸŒ… Nuevo DÃ­a', 'Todas las misiones han sido reiniciadas. Â¡Buena suerte!', 'ðŸŒ…');
            saveGame();
            renderQuests();
            updateStats();
            showToast('ðŸŒ…', 'Nuevo DÃ­a', 'Las misiones han sido reiniciadas');
        }

        // Confirmation Dialog System
        function showConfirmDialog(title, text, icon, callback) {
            document.getElementById('confirm-title').textContent = title;
            document.getElementById('confirm-text').textContent = text;
            document.getElementById('confirm-icon').textContent = icon;
            confirmCallback = callback;
            document.getElementById('confirm-dialog').classList.add('active');
        }

        function closeConfirmDialog() {
            document.getElementById('confirm-dialog').classList.remove('active');
            confirmCallback = null;
        }

        function executeConfirmAction() {
            if (confirmCallback) {
                confirmCallback();
                closeConfirmDialog();
            }
        }

        // Load and Save
        function loadGame() {
            const saved = localStorage.getItem('lifequest_data_v2');
            if (saved) {
                const parsed = JSON.parse(saved);
                gameState = { ...gameState, ...parsed };
                if (parsed.user) gameState.user = { ...gameState.user, ...parsed.user };
                if (parsed.achievements) gameState.achievements = parsed.achievements;
                if (parsed.notifications) gameState.notifications = parsed.notifications;
                if (parsed.stats) gameState.stats = { ...gameState.stats, ...parsed.stats };
                tempAvatar = gameState.user.avatar;
            }
        }

        function saveGame() {
            localStorage.setItem('lifequest_data_v2', JSON.stringify(gameState));
        }

        // Profile Functions
        function openProfileModal() {
            document.getElementById('profile-modal').classList.add('active');
            document.getElementById('edit-name').value = gameState.user.name;
            tempAvatar = gameState.user.avatar;
            renderAvatarGrid();
            updateToggles();
        }

        function closeProfileModal() {
            document.getElementById('profile-modal').classList.remove('active');
        }

        function renderAvatarGrid() {
            const grid = document.getElementById('avatar-grid');
            grid.innerHTML = avatars.map(avatar => `
                <div class="avatar-option ${avatar === tempAvatar ? 'selected' : ''}" 
                     onclick="selectAvatar('${avatar}')">
                    ${avatar}
                </div>
            `).join('');
        }

        function selectAvatar(avatar) {
            tempAvatar = avatar;
            renderAvatarGrid();
        }

        function updateToggles() {
            const notifToggle = document.getElementById('notif-toggle');
            const soundToggle = document.getElementById('sound-toggle');
            
            notifToggle.classList.toggle('active', gameState.user.settings.notifications);
            soundToggle.classList.toggle('active', gameState.user.settings.sounds);
        }

        function toggleSetting(setting) {
            gameState.user.settings[setting] = !gameState.user.settings[setting];
            updateToggles();
        }

        function saveProfile(e) {
            e.preventDefault();
            const newName = document.getElementById('edit-name').value.trim();
            if (newName) gameState.user.name = newName;
            gameState.user.avatar = tempAvatar;
            saveGame();
            updateUI();
            closeProfileModal();
            showToast('âœ…', 'Perfil Actualizado', 'Cambios guardados correctamente');
        }

        // Notifications
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        function sendNotification(title, body) {
            if (gameState.user.settings.notifications && 'Notification' in window && Notification.permission === 'granted') {
                new Notification(title, { body, icon: 'âš”ï¸' });
            }
        }

        function checkReminders() {
            const hour = new Date().getHours();
            if (hour === 9 || hour === 20) {
                const incomplete = Object.values(gameState.quests).flat().filter(q => !q.completed).length;
                if (incomplete > 0) {
                    sendNotification('LifeQuest', `Tienes ${incomplete} misiones pendientes hoy!`);
                }
            }
        }

        // Sound effects
        function playSound(type) {
            if (!gameState.user.settings.sounds) return;
            
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (type === 'complete') {
                oscillator.frequency.value = 800;
                gainNode.gain.value = 0.1;
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.1);
            } else if (type === 'levelup') {
                oscillator.frequency.value = 1200;
                gainNode.gain.value = 0.2;
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.3);
            }
        }

        // Render Functions
        function renderAll() {
            renderQuests();
            renderParty();
            renderShop();
            renderAchievements();
            renderChat();
            renderNotifications();
            updateUI();
        }

        function renderQuests() {
            const categories = ['health', 'work', 'mind', 'social'];
            
            categories.forEach(cat => {
                const container = document.getElementById(`${cat}-quests`);
                const quests = gameState.quests[cat];
                const completed = quests.filter(q => q.completed).length;
                
                document.getElementById(`${cat}-progress`).textContent = `${completed}/${quests.length} completadas`;
                
                container.innerHTML = quests.map(quest => `
                    <div class="quest-item ${quest.completed ? 'completed' : ''} ${quest.resetting ? 'resetting' : ''}" 
                         ondblclick="openQuestEditModal('${cat}', ${quest.id})"
                         title="Doble clic para editar">
                        <div class="quest-checkbox" onclick="event.stopPropagation(); toggleQuest('${cat}', ${quest.id})">
                            ${quest.completed ? 'âœ“' : ''}
                        </div>
                        <div class="quest-content" onclick="toggleQuest('${cat}', ${quest.id})">
                            <div class="quest-title">${quest.title}</div>
                            <div class="quest-meta">
                                <span class="streak-badge">ðŸ”¥ ${quest.streak}</span>
                                <div class="difficulty-dots">
                                    ${[1,2,3].map(i => `<div class="dot ${i <= quest.difficulty ? 'active' : ''}"></div>`).join('')}
                                </div>
                            </div>
                        </div>
                        <div class="quest-reward" onclick="toggleQuest('${cat}', ${quest.id})">
                            <div class="xp-reward">+${quest.xp}</div>
                            <div class="gold-reward">${quest.gold} ðŸª™</div>
                        </div>
                        <div class="quest-actions" onclick="event.stopPropagation()">
                            <button class="quest-btn edit" onclick="openQuestEditModal('${cat}', ${quest.id})" title="Editar">âœï¸</button>
                            <button class="quest-btn delete" onclick="confirmDeleteQuestDirect('${cat}', ${quest.id})" title="Eliminar">ðŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
            });
        }

        function toggleQuest(category, questId) {
            const quest = gameState.quests[category].find(q => q.id === questId);
            if (!quest) return;

            quest.completed = !quest.completed;
            
            if (quest.completed) {
                const now = new Date();
                quest.lastCompleted = now.toISOString();
                gameState.user.xp += quest.xp;
                gameState.user.gold += quest.gold;
                gameState.user.totalCompleted++;
                gameState.user.totalXp += quest.xp;
                gameState.stats.questsByCategory[category]++;
                
                playSound('complete');
                damageBoss(quest.xp);
                
                showToast('âœ¨', 'Â¡MisiÃ³n Completada!', `+${quest.xp} XP â€¢ +${quest.gold} Oro`);
                checkLevelUp();
                checkAchievements();
            } else {
                gameState.user.xp = Math.max(0, gameState.user.xp - quest.xp);
                gameState.user.gold = Math.max(0, gameState.user.gold - quest.gold);
                gameState.user.totalCompleted--;
                gameState.user.totalXp -= quest.xp;
                gameState.stats.questsByCategory[category]--;
            }
            
            saveGame();
            renderAll();
            updateStats();
        }

        // Quest Edit/Delete Functions
        function openQuestEditModal(category, questId) {
            const quest = gameState.quests[category].find(q => q.id === questId);
            if (!quest) return;
            
            currentEditingQuest = { category, questId };
            document.getElementById('edit-quest-id').value = questId;
            document.getElementById('edit-quest-category').value = category;
            document.getElementById('edit-quest-name').value = quest.title;
            document.getElementById('edit-quest-category-select').value = category;
            
            // Set difficulty
            editDifficulty = quest.difficulty;
            document.querySelectorAll('[data-edit-diff]').forEach(btn => {
                btn.classList.toggle('active', parseInt(btn.dataset.editDiff) === quest.difficulty);
            });
            
            document.getElementById('quest-edit-modal').classList.add('active');
        }

        function closeQuestEditModal() {
            document.getElementById('quest-edit-modal').classList.remove('active');
            currentEditingQuest = null;
        }

        function setEditDiff(d) {
            editDifficulty = d;
            document.querySelectorAll('[data-edit-diff]').forEach(btn => {
                btn.classList.toggle('active', parseInt(btn.dataset.editDiff) === d);
            });
        }

        function saveQuestEdit(e) {
            e.preventDefault();
            if (!currentEditingQuest) return;
            
            const { category, questId } = currentEditingQuest;
            const quest = gameState.quests[category].find(q => q.id === questId);
            if (!quest) return;
            
            const newTitle = document.getElementById('edit-quest-name').value.trim();
            const newCategory = document.getElementById('edit-quest-category-select').value;
            
            if (!newTitle) {
                showToast('âš ï¸', 'Error', 'El nombre no puede estar vacÃ­o');
                return;
            }
            
            // Update quest
            quest.title = newTitle;
            quest.difficulty = editDifficulty;
            quest.xp = editDifficulty * 15;
            quest.gold = editDifficulty * 5;
            
            // Move to different category if changed
            if (newCategory !== category) {
                const questIndex = gameState.quests[category].findIndex(q => q.id === questId);
                if (questIndex > -1) {
                    const [movedQuest] = gameState.quests[category].splice(questIndex, 1);
                    gameState.quests[newCategory].push(movedQuest);
                }
            }
            
            saveGame();
            renderQuests();
            closeQuestEditModal();
            showToast('âœ…', 'MisiÃ³n Actualizada', 'Los cambios se guardaron');
        }

        function confirmDeleteQuest() {
            if (!currentEditingQuest) return;
            const { category, questId } = currentEditingQuest;
            confirmDeleteQuestDirect(category, questId);
            closeQuestEditModal();
        }

        function confirmDeleteQuestDirect(category, questId) {
            const quest = gameState.quests[category].find(q => q.id === questId);
            if (!quest) return;
            
            showConfirmDialog(
                'Â¿Eliminar misiÃ³n?',
                `Â¿EstÃ¡s seguro de que quieres eliminar "${quest.title}"? Esta acciÃ³n no se puede deshacer.`,
                'ðŸ—‘ï¸',
                () => {
                    const questIndex = gameState.quests[category].findIndex(q => q.id === questId);
                    if (questIndex > -1) {
                        gameState.quests[category].splice(questIndex, 1);
                        saveGame();
                        renderQuests();
                        showToast('ðŸ—‘ï¸', 'MisiÃ³n Eliminada', 'La misiÃ³n ha sido eliminada');
                    }
                }
            );
        }

        function damageBoss(amount) {
            const boss = gameState.party.boss;
            boss.hp = Math.max(0, boss.hp - amount);
            
            if (boss.hp <= 0) {
                bossDefeated();
            }
            
            updateBossUI();
        }

        function bossDefeated() {
            playSound('levelup');
            showToast('ðŸ‘¹', 'Â¡Jefe Derrotado!', 'Todos ganan +500 XP y +100 Oro');
            gameState.user.xp += 500;
            gameState.user.gold += 100;
            
            gameState.party.boss.hp = gameState.party.boss.maxHp;
            gameState.party.boss.level++;
            gameState.party.boss.maxHp = Math.floor(gameState.party.boss.maxHp * 1.2);
            
            addChatMessage('Sistema', 'ðŸ¤–', `Â¡${gameState.party.boss.name} ha sido derrotado!`, true);
            addNotification('Â¡Jefe Derrotado!', 'Tu party derrotÃ³ al jefe semanal', 'ðŸŽ‰');
            
            checkLevelUp();
        }

        function updateBossUI() {
            const boss = gameState.party.boss;
            const percent = (boss.hp / boss.maxHp) * 100;
            document.getElementById('boss-hp-bar').style.width = percent + '%';
            document.getElementById('boss-hp-text').textContent = `${boss.hp}/${boss.maxHp} HP`;
        }

        function checkLevelUp() {
            while (gameState.user.xp >= gameState.user.xpToNext) {
                gameState.user.xp -= gameState.user.xpToNext;
                gameState.user.level++;
                gameState.user.xpToNext = Math.floor(gameState.user.xpToNext * 1.5);
                gameState.user.maxHp += 10;
                gameState.user.hp = gameState.user.maxHp;
                
                playSound('levelup');
                showLevelUp(gameState.user.level);
                addNotification('Â¡Subiste de Nivel!', `Ahora eres nivel ${gameState.user.level}`, 'â­');
            }
            updateUI();
        }

        function showLevelUp(level) {
            const overlay = document.getElementById('levelup-overlay');
            document.getElementById('new-level').textContent = level;
            overlay.classList.add('active');
            
            setTimeout(() => {
                overlay.classList.remove('active');
            }, 3000);
        }

        function checkAchievements() {
            const newUnlocks = [];
            const now = new Date().toLocaleDateString();
            
            gameState.achievements.forEach(ach => {
                if (ach.unlocked) return;
                
                let shouldUnlock = false;
                
                switch(ach.type) {
                    case 'quests_completed':
                        shouldUnlock = gameState.user.totalCompleted >= ach.requirement;
                        break;
                    case 'level':
                        shouldUnlock = gameState.user.level >= ach.requirement;
                        break;
                    case 'daily_streak':
                        shouldUnlock = gameState.user.currentStreak >= ach.requirement;
                        break;
                    case 'gold_1000':
                    case 'gold_5000':
                    case 'gold_10000':
                        shouldUnlock = gameState.user.gold >= ach.requirement;
                        break;
                    case 'achievements_count':
                        const unlockedCount = gameState.achievements.filter(a => a.unlocked).length;
                        shouldUnlock = unlockedCount >= ach.requirement;
                        break;
                    case 'shop_buy':
                        // Check if any shop item was bought (track in stats)
                        shouldUnlock = gameState.stats.shopBuys >= ach.requirement;
                        break;
                    case 'profile_edit':
                        shouldUnlock = gameState.stats.profileEdits >= ach.requirement;
                        break;
                    case 'login_streak':
                        shouldUnlock = gameState.user.loginStreak >= ach.requirement;
                        break;
                    case 'boss_defeat':
                    case 'boss_defeat_count':
                        shouldUnlock = gameState.stats.bossesDefeated >= ach.requirement;
                        break;
                    case 'perfect_days':
                        shouldUnlock = gameState.stats.perfectDays >= ach.requirement;
                        break;
                }
                
                if (shouldUnlock) {
                    ach.unlocked = true;
                    ach.unlockedDate = now;
                    newUnlocks.push(ach);
                }
            });
            
            newUnlocks.forEach(ach => {
                showToast('ðŸ†', 'Â¡Logro Desbloqueado!', `${ach.name}: ${ach.desc}`);
                addNotification('Â¡Logro Desbloqueado!', `Has desbloqueado: ${ach.name}`, ach.icon);
            });

            if (newUnlocks.length > 0) {
                saveGame();
                renderAchievements();
                updateProfileDisplay();
            }
        }

        function renderAchievements() {
            // Render in stats section (recent only)
            const container = document.getElementById('achievements-list');
            if (container) {
                const recentAchievements = gameState.achievements
                    .filter(a => a.unlocked)
                    .slice(-5)
                    .reverse();
                
                if (recentAchievements.length === 0) {
                    container.innerHTML = '<p style="color: #64748b; text-align: center;">Completa misiones para desbloquear logros</p>';
                } else {
                    container.innerHTML = recentAchievements.map(ach => `
                        <div class="achievement-item unlocked">
                            <div class="achievement-icon">${ach.icon}</div>
                            <div class="achievement-info">
                                <div class="achievement-name">${ach.name}</div>
                                <div class="achievement-desc">${ach.desc}</div>
                            </div>
                        </div>
                    `).join('');
                }
            }

            // Render detail view
            renderAchievementsDetail();
        }

        function renderAchievementsDetail() {
            const container = document.getElementById('achievements-detail-list');
            const categoriesContainer = document.getElementById('achievements-categories');
            if (!container || !categoriesContainer) return;

            const unlockedCount = gameState.achievements.filter(a => a.unlocked).length;
            const totalCount = gameState.achievements.length;
            const progressPercent = (unlockedCount / totalCount) * 100;

            const progressBar = document.getElementById('achievements-progress-bar');
            const progressText = document.getElementById('achievements-progress-text');
            
            if (progressBar) progressBar.style.width = progressPercent + '%';
            if (progressText) progressText.textContent = `${unlockedCount} de ${totalCount} logros desbloqueados`;

            // Get unique categories
            const categories = [...new Set(gameState.achievements.map(a => a.category))];
            
            // Render category buttons
            categoriesContainer.innerHTML = categories.map(cat => {
                const catAchievements = gameState.achievements.filter(a => a.category === cat);
                const catUnlocked = catAchievements.filter(a => a.unlocked).length;
                return `
                    <button class="achievement-category-btn" onclick="filterAchievements('${cat}')">
                        ${cat} (${catUnlocked}/${catAchievements.length})
                    </button>
                `;
            }).join('');

            // Render achievements
            renderAchievementsList(gameState.achievements);
        }

        function filterAchievements(category) {
            const filtered = gameState.achievements.filter(a => a.category === category);
            renderAchievementsList(filtered);
            
            // Update active button
            document.querySelectorAll('.achievement-category-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.includes(category));
            });
        }

        function renderAchievementsList(achievements) {
            const container = document.getElementById('achievements-detail-list');
            container.innerHTML = achievements.map(ach => `
                <div class="achievement-detail-card ${ach.unlocked ? 'unlocked' : 'locked'}">
                    <div class="achievement-detail-icon">${ach.icon}</div>
                    <div class="achievement-detail-info">
                        <div class="achievement-detail-name">${ach.name}</div>
                        <div class="achievement-detail-desc">${ach.desc}</div>
                        <div class="achievement-detail-date">
                            ${ach.unlocked ? `âœ“ Desbloqueado el ${ach.unlockedDate || 'Recientemente'}` : 'ðŸ”’ Bloqueado'}
                        </div>
                        ${!ach.unlocked ? `
                            <div class="achievement-progress-mini">
                                <div class="achievement-progress-mini-fill" style="width: ${Math.min(100, (ach.progress || 0) / ach.requirement * 100)}%"></div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function renderParty() {
            document.getElementById('party-code').textContent = gameState.party.code;
            document.getElementById('member-count').textContent = `${gameState.party.members.length}/4`;
            
            const grid = document.getElementById('members-grid');
            grid.innerHTML = gameState.party.members.map(member => `
                <div class="member-card ${member.isYou ? 'you' : ''} ${member.isLeader ? 'leader' : ''}">
                    ${member.isLeader ? '<span class="leader-badge">LÃDER</span>' : ''}
                    <div class="member-avatar">
                        ${member.avatar}
                        <span class="member-status" style="background: ${member.status === 'online' ? 'var(--success)' : '#64748b'}"></span>
                    </div>
                    <div class="member-name">${member.name}</div>
                    <div class="member-level">Nv. ${member.level}</div>
                </div>
            `).join('');
            
            updateBossUI();
        }

        function renderChat() {
            const container = document.getElementById('chat-messages');
            container.innerHTML = gameState.party.chat.map(msg => `
                <div class="chat-message ${msg.isSystem ? 'system' : ''}">
                    <div class="chat-avatar">${msg.avatar}</div>
                    <div class="chat-content">
                        <div class="chat-author" style="color: ${msg.isSystem ? 'var(--party)' : 'inherit'}">${msg.author}</div>
                        <div class="chat-text">${msg.text}</div>
                    </div>
                </div>
            `).join('');
            
            container.scrollTop = container.scrollHeight;
        }

        function setupChatInput() {
            const input = document.getElementById('chat-input');
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            
            if (text) {
                addChatMessage('TÃº', gameState.user.avatar, text);
                input.value = '';
                
                setTimeout(() => {
                    const responses = [
                        { author: 'MarÃ­a', avatar: 'âš”ï¸', text: 'Â¡Genial! ðŸ’ª' },
                        { author: 'Carlos', avatar: 'ðŸ¹', text: 'Vamos por ese jefe' },
                        { author: 'MarÃ­a', avatar: 'âš”ï¸', text: 'Yo ya completÃ© 3 hoy' }
                    ];
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    addChatMessage(randomResponse.author, randomResponse.avatar, randomResponse.text);
                }, 2000);
            }
        }

        function addChatMessage(author, avatar, text, isSystem = false) {
            gameState.party.chat.push({ author, avatar, text, isSystem, time: new Date().toLocaleTimeString() });
            if (gameState.party.chat.length > 20) gameState.party.chat.shift();
            renderChat();
        }

        function renderShop() {
            const container = document.getElementById('shop-grid');
            container.innerHTML = gameState.shop.map(item => {
                const canBuy = gameState.user.gold >= item.cost;
                return `
                    <div class="shop-item ${!canBuy ? 'locked' : ''}" onclick="${canBuy ? `buyItem(${item.id})` : ''}">
                        <span class="shop-icon">${item.icon}</span>
                        <div class="shop-name">${item.name}</div>
                        <div class="shop-desc">${item.desc}</div>
                        <div class="shop-price">${item.cost} ðŸª™</div>
                    </div>
                `;
            }).join('');
        }

        function buyItem(id) {
            const item = gameState.shop.find(i => i.id === id);
            if (gameState.user.gold >= item.cost) {
                gameState.user.gold -= item.cost;
                gameState.stats.shopBuys = (gameState.stats.shopBuys || 0) + 1;
                showToast('ðŸŽ', 'Recompensa Comprada', `Disfruta: ${item.name}`);
                addNotification('Compra Exitosa', `Has comprado: ${item.name}`, 'ðŸ›’');
                checkAchievements();
                saveGame();
                updateStats();
                renderShop();
            }
        }

        // Notifications System
        function addNotification(title, text, icon = 'ðŸ””') {
            const newNotif = {
                id: Date.now(),
                title: title,
                text: text,
                icon: icon,
                unread: true,
                time: 'Ahora'
            };
            gameState.notifications.unshift(newNotif);
            if (gameState.notifications.length > 50) gameState.notifications.pop();
            saveGame();
            renderNotifications();
            updateNotificationBadge();
        }

        function renderNotifications() {
            const container = document.getElementById('notifications-list');
            const clearBtn = document.getElementById('clear-all-btn');
            const badge = document.getElementById('notif-badge');
            
            if (!container) return;
            
            // Update badge
            const unreadCount = gameState.notifications.filter(n => n.unread).length;
            if (badge) {
                badge.textContent = unreadCount;
                badge.style.display = unreadCount > 0 ? 'flex' : 'none';
            }
            
            // Show/hide clear button
            if (clearBtn) {
                clearBtn.style.display = gameState.notifications.length > 0 ? 'block' : 'none';
            }
            
            if (gameState.notifications.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ðŸ””</div>
                        <div class="empty-state-text">No tienes notificaciones</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = gameState.notifications.map(notif => `
                <div class="notification-item ${notif.unread ? 'unread' : ''}" onclick="markNotificationRead(${notif.id})">
                    <div class="notification-icon">${notif.icon}</div>
                    <div class="notification-content">
                        <div class="notification-title">${notif.title}</div>
                        <div class="notification-text">${notif.text}</div>
                        <div class="notification-time">${notif.time}</div>
                    </div>
                </div>
            `).join('');
        }

        function markNotificationRead(id) {
            const notif = gameState.notifications.find(n => n.id === id);
            if (notif) {
                notif.unread = false;
                saveGame();
                renderNotifications();
            }
        }

        function clearAllNotifications() {
            showConfirmDialog(
                'Â¿Limpiar notificaciones?',
                'Â¿EstÃ¡s seguro de que quieres eliminar todas las notificaciones?',
                'ðŸ—‘ï¸',
                () => {
                    gameState.notifications = [];
                    saveGame();
                    renderNotifications();
                    showToast('ðŸ—‘ï¸', 'Notificaciones', 'Todas las notificaciones han sido eliminadas');
                }
            );
        }

        function updateNotificationBadge() {
            const badge = document.getElementById('notif-badge');
            const unreadCount = gameState.notifications.filter(n => n.unread).length;
            if (badge) {
                badge.textContent = unreadCount;
                badge.style.display = unreadCount > 0 ? 'flex' : 'none';
            }
        }

        function updateUI() {
            document.getElementById('char-name').textContent = gameState.user.name;
            document.getElementById('char-class').textContent = `Nv. ${gameState.user.level} Aventurero`;
            document.getElementById('avatar-emoji').textContent = gameState.user.avatar;
            document.getElementById('hp-bar').style.width = (gameState.user.hp/gameState.user.maxHp*100) + '%';
            document.getElementById('xp-bar').style.width = (gameState.user.xp/gameState.user.xpToNext*100) + '%';
            
            document.getElementById('total-completed').textContent = gameState.user.totalCompleted;
            document.getElementById('max-streak').textContent = gameState.user.longestStreak;
            document.getElementById('current-level').textContent = gameState.user.level;
            document.getElementById('total-xp').textContent = gameState.user.totalXp;
        }

        function updateStats() {
            document.getElementById('stat-xp').textContent = gameState.user.xp;
            document.getElementById('stat-gold').textContent = gameState.user.gold;
            document.getElementById('stat-streak').textContent = gameState.user.currentStreak;
            document.getElementById('stat-hp').textContent = gameState.user.hp;
        }

        function showSection(section) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            const sectionMap = {
                'quests': 0,
                'party': 1,
                'shop': 2,
                'profile': 3
            };

            if (section === 'stats') {
                document.getElementById('stats-section').classList.add('active');
                document.querySelectorAll('.tab')[3].classList.add('active');
            } else if (section === 'achievements-detail') {
                document.getElementById('achievements-detail-section').classList.add('active');
                document.querySelectorAll('.tab')[3].classList.add('active');
                renderAchievementsDetail();
            } else if (section === 'notifications') {
                document.getElementById('notifications-section').classList.add('active');
                renderNotifications();
            } else if (sectionMap[section] !== undefined) {
                document.getElementById(`${section}-section`).classList.add('active');
                document.querySelectorAll('.tab')[sectionMap[section]].classList.add('active');
                document.querySelectorAll('.nav-item')[sectionMap[section]].classList.add('active');
            }
        }

        function openModal() {
            document.getElementById('quest-modal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('quest-modal').classList.remove('active');
        }

        function setDiff(d) {
            selectedDifficulty = d;
            document.querySelectorAll('.difficulty-btn').forEach(b => {
                b.classList.toggle('active', parseInt(b.dataset.diff) === d);
            });
        }

        function addQuest(e) {
            e.preventDefault();
            
            const name = document.getElementById('quest-name').value;
            const cat = document.getElementById('quest-category').value;
            
            const newQuest = {
                id: Date.now(),
                title: name,
                difficulty: selectedDifficulty,
                completed: false,
                streak: 0,
                xp: selectedDifficulty * 15,
                gold: selectedDifficulty * 5,
                lastCompleted: null
            };
            
            gameState.quests[cat].push(newQuest);
            gameState.stats.totalQuestsCreated++;
            saveGame();
            renderQuests();
            closeModal();
            showToast('âš”ï¸', 'MisiÃ³n Creada', 'Â¡Nueva aventura comienza!');
            addNotification('Nueva MisiÃ³n', `Has creado: ${name}`, 'âš”ï¸');
            document.getElementById('quest-name').value = '';
        }

        function shareParty() {
            const code = gameState.party.code;
            if (navigator.share) {
                navigator.share({
                    title: 'Ãšnete a mi Party en LifeQuest',
                    text: `Â¡Ãšnete a mi grupo! CÃ³digo: ${code}`,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(`Â¡Ãšnete a mi Party en LifeQuest! CÃ³digo: ${code}`);
                showToast('ðŸ“‹', 'Copiado', 'CÃ³digo copiado al portapapeles');
            }
        }

        function joinParty() {
            const code = prompt('Ingresa el cÃ³digo de Party:');
            if (code) {
                showToast('ðŸ‘¥', 'UniÃ©ndose...', `Conectando a Party ${code}`);
                setTimeout(() => {
                    showToast('âœ…', 'Â¡Conectado!', 'Ahora eres parte de la Party');
                    addNotification('Nuevo Miembro', 'Carlos se uniÃ³ a tu party', 'ðŸ‘¥');
                }, 1500);
            }
        }

        function showToast(icon, title, msg) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
                <div class="toast-icon">${icon}</div>
                <div class="toast-content">
                    <h4>${title}</h4>
                    <p>${msg}</p>
                </div>
            `;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // Event Listeners for modals
        document.getElementById('quest-modal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeModal();
        });

        document.getElementById('profile-modal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeProfileModal();
        });

        document.getElementById('quest-edit-modal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeQuestEditModal();
        });

        // PROFILE FUNCTIONS
        function checkFirstTime() {
            const saved = localStorage.getItem('lifequest_profile');
            if (!saved) {
                isFirstTime = true;
                setTimeout(() => {
                    openProfileEditModal();
                    document.getElementById('profile-modal-title').textContent = 'ðŸŽ‰ Bienvenido a LifeQuest';
                    document.getElementById('profile-info-text').style.display = 'block';
                    document.getElementById('profile-submit-btn').textContent = 'Comenzar Aventura';
                }, 500);
            } else {
                const profile = JSON.parse(saved);
                gameState.user.name = profile.name;
                gameState.user.email = profile.email;
                gameState.user.avatar = profile.avatar;
                gameState.user.settings = profile.settings || { notifications: true, sounds: true };
                gameState.user.joinDate = profile.joinDate || new Date().toLocaleDateString();
                updateProfileDisplay();
            }
        }

        function openProfileEditModal() {
            document.getElementById('profile-edit-modal').classList.add('active');
            document.getElementById('profile-name-input').value = gameState.user.name;
            document.getElementById('profile-email-input').value = gameState.user.email || '';
            renderEditAvatarGrid();
            updatePreferenceToggles();
        }

        function closeProfileEditModal() {
            document.getElementById('profile-edit-modal').classList.remove('active');
            if (isFirstTime) {
                document.getElementById('profile-modal-title').textContent = 'ðŸ“ Editar Perfil';
                document.getElementById('profile-info-text').style.display = 'none';
                document.getElementById('profile-submit-btn').textContent = 'Guardar Cambios';
            }
        }

        function renderEditAvatarGrid() {
            const grid = document.getElementById('edit-avatar-grid');
            grid.innerHTML = avatars.map(avatar => `
                <div class="avatar-option ${avatar === gameState.user.avatar ? 'selected' : ''}" 
                     onclick="selectProfileAvatar('${avatar}')">
                    ${avatar}
                </div>
            `).join('');
        }

        function selectProfileAvatar(avatar) {
            gameState.user.avatar = avatar;
            renderEditAvatarGrid();
        }

        function updatePreferenceToggles() {
            const notifToggle = document.getElementById('pref-notifications');
            const soundToggle = document.getElementById('pref-sounds');
            
            notifToggle.classList.toggle('active', gameState.user.settings.notifications);
            soundToggle.classList.toggle('active', gameState.user.settings.sounds);
        }

        function togglePreference(pref) {
            gameState.user.settings[pref] = !gameState.user.settings[pref];
            updatePreferenceToggles();
        }

        function saveProfileData(e) {
            e.preventDefault();
            
            const name = document.getElementById('profile-name-input').value.trim();
            const email = document.getElementById('profile-email-input').value.trim();
            
            if (!name) {
                showToast('âš ï¸', 'Error', 'El nombre es obligatorio');
                return;
            }
            
            gameState.user.name = name;
            gameState.user.email = email;
            
            if (!gameState.user.joinDate) {
                gameState.user.joinDate = new Date().toLocaleDateString();
            }
            
            gameState.stats.profileEdits = (gameState.stats.profileEdits || 0) + 1;
            
            const profileData = {
                name: gameState.user.name,
                email: gameState.user.email,
                avatar: gameState.user.avatar,
                settings: gameState.user.settings,
                joinDate: gameState.user.joinDate
            };
            localStorage.setItem('lifequest_profile', JSON.stringify(profileData));
            
            saveGame();
            updateProfileDisplay();
            updateUI();
            closeProfileEditModal();
            checkAchievements();
            
            if (isFirstTime) {
                isFirstTime = false;
                showToast('ðŸŽ‰', 'Â¡Bienvenido!', `Suerte en tu aventura, ${name}!`);
            } else {
                showToast('âœ…', 'Perfil Actualizado', 'Tus cambios se guardaron');
            }
        }

        function updateProfileDisplay() {
            document.getElementById('profile-display-name').textContent = gameState.user.name;
            document.getElementById('profile-display-email').textContent = gameState.user.email || 'Sin email';
            document.getElementById('profile-avatar-emoji').textContent = gameState.user.avatar;
            document.getElementById('profile-level').textContent = gameState.user.level;
            document.getElementById('profile-xp').textContent = gameState.user.totalXp;
            document.getElementById('profile-joined').textContent = gameState.user.joinDate || 'Hoy';
            
            const unlockedCount = gameState.achievements.filter(a => a.unlocked).length;
            const badge = document.getElementById('achievements-count');
            if (badge) badge.textContent = unlockedCount;
            
            const grid = document.getElementById('profile-achievements-grid');
            const unlockedAchievements = gameState.achievements.filter(a => a.unlocked).slice(-4);
            
            if (grid) {
                grid.innerHTML = unlockedAchievements.map(a => `
                    <div class="achievement-preview unlocked">${a.icon}</div>
                `).join('');
                
                const emptySlots = 4 - unlockedAchievements.length;
                for (let i = 0; i < emptySlots; i++) {
                    grid.innerHTML += `<div class="achievement-preview">ðŸ”’</div>`;
                }
            }
        }

        function exportData() {
            const data = {
                profile: JSON.parse(localStorage.getItem('lifequest_profile')),
                game: gameState,
                exportDate: new Date().toISOString()
            };
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `lifequest-backup-${Date.now()}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showToast('ðŸ’¾', 'Datos Exportados', 'Backup descargado correctamente');
        }

        function confirmResetData() {
            showConfirmDialog(
                'Â¿Reiniciar todo?',
                'Â¿EstÃ¡s seguro de que quieres borrar TODOS tus datos? Esta acciÃ³n no se puede deshacer.',
                'âš ï¸',
                () => {
                    showConfirmDialog(
                        'Â¿De verdad?',
                        'Esta es tu Ãºltima oportunidad. Â¿Deseas continuar?',
                        'ðŸ—‘ï¸',
                        () => {
                            localStorage.removeItem('lifequest_data_v2');
                            localStorage.removeItem('lifequest_profile');
                            location.reload();
                        }
                    );
                }
            );
        }

        // Close profile modal on outside click
        document.getElementById('profile-edit-modal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget && !isFirstTime) closeProfileEditModal();
        });
    </script>
</body>
</html>
